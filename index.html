<!DOCTYPE html>
<html lang="ar">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>موقع براعم جوجو</title>
    <link href="https://fonts.googleapis.com/css2?family=Cairo:wght@400;700&display=swap" rel="stylesheet">
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        /* تعريف الخط الأساسي للجسم والخلفية المتدرجة الدافئة والداكنة */
        body {
            font-family: 'Cairo', sans-serif;
            background: linear-gradient(135deg, #332e40, #221c27); /* لون بنفسجي داكن مائل للرمادي، حنون وثابت */
            display: flex;
            flex-direction: column; /* Allow content to stack vertically */
            justify-content: center;
            align-items: center;
            min-height: 100vh; /* Ensure background covers full viewport height */
            margin: 0;
            position: relative; /* لجعل القلوب الخلفية تتموضع بالنسبة للجسم */
            padding-bottom: 3rem; /* Add some padding at the bottom for scrolling content */
            padding-top: 2rem; /* Add some padding at the top */
        }
        /* حاوية المحتوى الرئيسية بتصميم ناعم ومستدير وداكن */
        .container {
            background-color: rgba(0, 0, 0, 0.4);
            border-radius: 2rem;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.3);
            padding: 2.5rem;
            text-align: center;
            max-width: 90%;
            width: 100%; /* Ensure it takes full width within max-width */
            position: relative;
            z-index: 10; /* تأكد من أن المحتوى فوق القلوب المتحركة */
            overflow: hidden; /* Keep overflow hidden for the container itself */
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
        }
        /* تصميم نص "تم تصميمه بالكامل من أجل جوجو" بلون فاتح وتحريك عصري */
        .text-jojo {
            color: #f8bbd0;
            font-size: 2.5rem;
            font-weight: 700;
            margin-bottom: 1rem;
            line-height: 1.3;
            animation: textGlowPulse 3s infinite alternate;
            text-shadow: 0 0 5px rgba(248, 187, 208, 0.5);
        }
        /* أيقونة القلب مع تحريك نبض لطيف */
        .heart-icon {
            display: inline-block;
            color: #f8bbd0;
            margin-left: 0.5rem;
            /* تحريك النبض للقلب يتم دمجه مع تحريك النص */
        }

        /* تصميم نص "نوم الهنا والعافية" */
        .text-jojo-sub {
            color: #e0f7fa;
            font-size: 1.5rem;
            font-weight: 400;
            margin-top: 0;
            margin-bottom: 2rem;
            line-height: 1.2;
        }

        /* أيقونة Zzz مع تحريك لطيف */
        .zzz-icon {
            display: inline-block;
            color: #e0f7fa;
            margin-left: 0.5rem;
            font-size: 1.8rem;
            animation: zzzFloat 2s infinite alternate ease-in-out;
        }

        /* قلوب خلفية متحركة - الآن على كامل الشاشة */
        .heart-shape {
            position: absolute; /* تموضع مطلق بالنسبة للجسم */
            background-color: rgba(255, 255, 255, 0.1); /* لون أبيض شفاف أكثر خفوتاً */
            border-radius: 50%;
            animation: pulseHeart 6s infinite ease-in-out; /* حركة نبض أبطأ للقلوب */
            opacity: 0;
            z-index: 0; /* تكون خلف المحتوى الرئيسي */
            filter: blur(7px); /* تأثير ضبابي أكثر لمظهر أكثر نعومة وخفوت */
        }
        /* شكل القلب الحقيقي باستخدام pseudo-elements */
        .heart-shape::before,
        .heart-shape::after {
            content: '';
            position: absolute;
            width: 100%;
            height: 100%;
            background-color: inherit; /* يرث لون القلب الرئيسي */
            border-radius: 50%;
        }
        .heart-shape::before {
            top: -50%;
            left: 0;
        }
        .heart-shape::after {
            top: 0;
            left: 50%;
            transform: rotate(90deg);
            transform-origin: 0% 100%;
        }

        /* خصائص لكل قلب لتحريك وتموضع مختلف على كامل الشاشة */
        .heart-shape:nth-child(1) {
            width: 80px; height: 80px;
            top: 10%; left: 15%;
            animation-delay: 0s;
            transform: rotate(-20deg);
        }
        .heart-shape:nth-child(2) {
            width: 100px; height: 100px;
            bottom: 5%; right: 10%;
            animation-delay: 1s;
            transform: rotate(30deg);
        }
        .heart-shape:nth-child(3) {
            width: 60px; height: 60px;
            top: 50%; left: 5%;
            animation-delay: 2s;
            transform: rotate(10deg);
        }
        .heart-shape:nth-child(4) {
            width: 90px; height: 90px;
            top: 20%; right: 25%;
            animation-delay: 3s;
            transform: rotate(-40deg);
        }
        .heart-shape:nth-child(5) {
            width: 70px; height: 70px;
            bottom: 20%; left: 30%;
            animation-delay: 0.5s;
            background-color: rgba(255, 204, 229, 0.1);
            transform: rotate(50deg);
        }
        .heart-shape:nth-child(6) {
            width: 50px; height: 50px;
            top: 40%; right: 5%;
            animation-delay: 2.5s;
            background-color: rgba(179, 229, 252, 0.1);
            transform: rotate(-10deg);
        }
        /* إضافة المزيد من القلوب لتغطية الشاشة بشكل أفضل */
        .heart-shape:nth-child(7) {
            width: 75px; height: 75px;
            top: 70%; left: 18%;
            animation-delay: 4s;
            transform: rotate(15deg);
        }
        .heart-shape:nth-child(8) {
            width: 85px; height: 85px;
            top: 5%; right: 50%;
            animation-delay: 1.5s;
            transform: rotate(-35deg);
        }
        .heart-shape:nth-child(9) {
            width: 65px; height: 65px;
            bottom: 10%; left: 45%;
            animation-delay: 3.5s;
            transform: rotate(25deg);
        }

        /* تعريف تحريك النبض للقلوب */
        @keyframes pulseHeart {
            0% {
                transform: scale(0) rotate(var(--rotation, 0deg));
                opacity: 0;
            }
            50% {
                transform: scale(1) rotate(var(--rotation, 0deg));
                opacity: 0.15;
            }
            100% {
                transform: scale(0) rotate(var(--rotation, 0deg));
                opacity: 0;
            }
        }

        /* تعريف تحريك نبض القلب (الأيقونة الصغيرة) */
        @keyframes beat {
            0% { transform: scale(1); }
            100% { transform: scale(1.1); }
        }

        /* تحريك توهج ونبض النص (textGlowPulse) */
        @keyframes textGlowPulse {
            0% {
                transform: scale(1);
                text-shadow: 0 0 5px rgba(248, 187, 208, 0.5);
            }
            50% {
                transform: scale(1.02);
                text-shadow: 0 0 15px rgba(248, 187, 208, 0.8), 0 0 25px rgba(248, 187, 208, 0.3);
            }
            100% {
                transform: scale(1);
                text-shadow: 0 0 5px rgba(248, 187, 208, 0.5);
            }
        }

        /* تحريك طفو Zzz */
        @keyframes zzzFloat {
            0% { transform: translateY(0); opacity: 1; }
            50% { transform: translateY(-8px); opacity: 0.7; }
            100% { transform: translateY(0); opacity: 1; }
        }

        /* تصميم زر التشغيل */
        .play-button {
            background-color: #7e57c2;
            color: white;
            padding: 1rem 2rem;
            border-radius: 9999px;
            font-size: 1.5rem;
            font-weight: 700;
            cursor: pointer;
            transition: background-color 0.3s ease, transform 0.2s ease;
            display: flex;
            align-items: center;
            justify-content: center;
            margin-top: 2rem;
            border: none;
        }
        .play-button:hover {
            background-color: #673ab7;
            transform: translateY(-2px);
        }
        .play-button:active {
            transform: translateY(0);
        }
        .play-icon {
            margin-left: 0.75rem;
            font-size: 1.8rem;
        }

        /* أنماط خاصة بميزات Gemini API */
        .gemini-feature-section {
            background-color: rgba(255, 255, 255, 0.08); /* خلفية خافتة للقسم */
            border-radius: 1rem;
            padding: 1.5rem;
            margin-top: 2.5rem;
            width: 100%;
            max-width: 500px; /* تحديد أقصى عرض للقسم */
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.2);
            display: flex;
            flex-direction: column;
            align-items: center;
        }
        .gemini-feature-section h2 {
            font-size: 1.6rem;
            font-weight: 700;
            margin-bottom: 1rem;
        }
        .gemini-feature-section textarea,
        .gemini-feature-section input[type="text"] {
            width: 100%;
            background-color: rgba(255, 255, 255, 0.15); /* خلفية خافتة لمربع النص */
            border: 1px solid rgba(255, 255, 255, 0.2);
            border-radius: 0.75rem;
            padding: 0.75rem;
            color: #e0f7fa; /* لون النص الفاتح */
            font-size: 1rem;
            resize: vertical; /* السماح بتغيير حجم مربع النص عمودياً */
            min-height: 80px;
            outline: none; /* إزالة الإطار عند التركيز */
            transition: border-color 0.3s ease;
            margin-bottom: 1rem;
        }
        .gemini-feature-section input[type="text"] {
            min-height: auto; /* Override min-height for single-line input */
        }
        .gemini-feature-section textarea:focus,
        .gemini-feature-section input[type="text"]:focus {
            border-color: #f8bbd0; /* لون وردي عند التركيز */
        }
        .gemini-feature-section button {
            background-color: #f8bbd0; /* لون وردي للزر */
            color: #332e40; /* لون النص الداكن */
            padding: 0.75rem 1.5rem;
            border-radius: 9999px;
            font-size: 1.1rem;
            font-weight: 700;
            cursor: pointer;
            transition: background-color 0.3s ease, transform 0.2s ease;
            margin-top: 0.5rem;
            border: none;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        .gemini-feature-section button:hover {
            background-color: #f48fb1; /* لون وردي أغمق عند التمرير */
            transform: translateY(-2px);
        }
        .gemini-feature-section button:active {
            transform: translateY(0);
        }
        .gemini-output {
            background-color: rgba(255, 255, 255, 0.05); /* خلفية أغمق للقصة */
            border-radius: 0.75rem;
            padding: 1rem;
            margin-top: 1.5rem;
            color: #e0f7fa; /* لون النص الفاتح */
            font-size: 1rem;
            text-align: right; /* محاذاة النص لليمين */
            line-height: 1.6;
            max-height: 250px; /* أقصى ارتفاع لمنطقة القصة */
            overflow-y: auto; /* إضافة شريط تمرير إذا كانت القصة طويلة */
            white-space: pre-wrap; /* للحفاظ على تنسيق النص والأسطر الجديدة */
            width: 100%;
        }
        .loading-indicator {
            display: flex;
            align-items: center;
            justify-content: center;
            color: #f8bbd0;
            font-size: 1.1rem;
            margin-top: 1rem;
        }
        .loading-indicator .spinner {
            border: 4px solid rgba(248, 187, 208, 0.3);
            border-top: 4px solid #f8bbd0;
            border-radius: 50%;
            width: 24px;
            height: 24px;
            animation: spin 1s linear infinite;
            margin-left: 0.5rem;
        }
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        /* أنماط زر الاستماع للقصة */
        .listen-button {
            background-color: #81c784; /* لون أخضر لطيف */
            color: white;
            padding: 0.75rem 1.5rem;
            border-radius: 9999px;
            font-size: 1.1rem;
            font-weight: 700;
            cursor: pointer;
            transition: background-color 0.3s ease, transform 0.2s ease;
            margin-top: 1rem;
            border: none;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        .listen-button:hover {
            background-color: #66bb6a;
            transform: translateY(-2px);
        }
        .listen-button:active {
            transform: translateY(0);
        }
        .listen-icon {
            margin-left: 0.5rem;
        }

        /* أنماط قسم الألعاب */
        .games-section {
            background-color: rgba(255, 255, 255, 0.08);
            border-radius: 1rem;
            padding: 1.5rem;
            margin-top: 2.5rem;
            width: 100%;
            max-width: 500px;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.2);
            display: flex;
            flex-direction: column;
            align-items: center;
        }
        .games-section h2 {
            color: #b3e5fc; /* لون أزرق فاتح للعناوين */
            font-size: 1.8rem;
            font-weight: 700;
            margin-bottom: 1.5rem;
            text-shadow: 0 0 5px rgba(179, 229, 252, 0.5);
        }

        /* أنماط لعبة X-O (Tic-Tac-Toe) */
        .tic-tac-toe-game {
            margin-bottom: 2rem;
            width: 100%;
            display: flex;
            flex-direction: column;
            align-items: center;
        }
        .tic-tac-toe-game h3 {
            color: #e0f7fa;
            font-size: 1.3rem;
            margin-bottom: 1rem;
        }
        .tic-tac-toe-board {
            display: grid;
            grid-template-columns: repeat(3, 80px);
            grid-template-rows: repeat(3, 80px);
            gap: 5px;
            background-color: rgba(255, 255, 255, 0.1);
            border-radius: 0.5rem;
            padding: 5px;
        }
        .tic-tac-toe-cell {
            width: 80px;
            height: 80px;
            background-color: rgba(255, 255, 255, 0.15);
            border-radius: 0.5rem;
            display: flex;
            justify-content: center;
            align-items: center;
            font-size: 3rem;
            font-weight: 700;
            cursor: pointer;
            color: #f8bbd0; /* لون اللاعب X */
            transition: background-color 0.2s ease;
        }
        .tic-tac-toe-cell.o {
            color: #81c784; /* لون اللاعب O */
        }
        .tic-tac-toe-cell:hover {
            background-color: rgba(255, 255, 255, 0.25);
        }
        .tic-tac-toe-reset-button {
            background-color: #7e57c2;
            color: white;
            padding: 0.6rem 1.2rem;
            border-radius: 9999px;
            font-size: 1rem;
            font-weight: 700;
            cursor: pointer;
            transition: background-color 0.3s ease, transform 0.2s ease;
            margin-top: 1rem;
            border: none;
        }
        .tic-tac-toe-reset-button:hover {
            background-color: #673ab7;
            transform: translateY(-2px);
        }

        /* أنماط لعبة حجر ورقة مقص (Rock-Paper-Scissors) */
        .rps-game {
            width: 100%;
            display: flex;
            flex-direction: column;
            align-items: center;
            margin-bottom: 2rem; /* Add margin to separate from next game */
        }
        .rps-game h3 {
            color: #e0f7fa;
            font-size: 1.3rem;
            margin-bottom: 1rem;
        }
        .rps-choices {
            display: flex;
            gap: 1rem;
            margin-bottom: 1.5rem;
        }
        .rps-choice-button {
            background-color: #f8bbd0;
            color: #332e40;
            padding: 1rem 1.5rem;
            border-radius: 1rem;
            font-size: 2rem;
            cursor: pointer;
            transition: background-color 0.3s ease, transform 0.2s ease;
            border: none;
            display: flex;
            justify-content: center;
            align-items: center;
            box-shadow: 0 4px 10px rgba(0, 0, 0, 0.2);
        }
        .rps-choice-button:hover {
            background-color: #f48fb1;
            transform: translateY(-3px);
        }
        .rps-choice-button:active {
            transform: translateY(0);
        }
        .rps-result {
            color: #e0f7fa;
            font-size: 1.2rem;
            font-weight: 700;
            min-height: 30px; /* للحفاظ على المساحة حتى لو لم يكن هناك نص */
        }

        /* أنماط لعبة تخمين الرقم (Guess the Number) */
        .guess-number-game {
            width: 100%;
            display: flex;
            flex-direction: column;
            align-items: center;
            margin-bottom: 2rem;
        }
        .guess-number-game h3 {
            color: #e0f7fa;
            font-size: 1.3rem;
            margin-bottom: 1rem;
        }
        .guess-number-game input[type="number"] {
            width: 100px;
            background-color: rgba(255, 255, 255, 0.15);
            border: 1px solid rgba(255, 255, 255, 0.2);
            border-radius: 0.75rem;
            padding: 0.5rem;
            color: #e0f7fa;
            font-size: 1.2rem;
            text-align: center;
            outline: none;
            transition: border-color 0.3s ease;
            margin-bottom: 1rem;
        }
        .guess-number-game input[type="number"]:focus {
            border-color: #b3e5fc;
        }
        .guess-number-game button {
            background-color: #b3e5fc; /* لون أزرق فاتح للزر */
            color: #332e40;
            padding: 0.75rem 1.5rem;
            border-radius: 9999px;
            font-size: 1.1rem;
            font-weight: 700;
            cursor: pointer;
            transition: background-color 0.3s ease, transform 0.2s ease;
            border: none;
            display: flex;
            align-items: center;
            justify-content: center;
            margin-bottom: 1rem;
        }
        .guess-number-game button:hover {
            background-color: #81d4fa;
            transform: translateY(-2px);
        }
        .guess-number-game button:active {
            transform: translateY(0);
        }
        .guess-number-game .message {
            color: #e0f7fa;
            font-size: 1.1rem;
            min-height: 25px; /* للحفاظ على المساحة */
        }
        .guess-number-game .reset-button {
            background-color: #7e57c2;
            color: white;
            padding: 0.6rem 1.2rem;
            border-radius: 9999px;
            font-size: 1rem;
            font-weight: 700;
            cursor: pointer;
            transition: background-color 0.3s ease, transform 0.2s ease;
            margin-top: 1rem;
            border: none;
        }
        .guess-number-game .reset-button:hover {
            background-color: #673ab7;
            transform: translateY(-2px);
        }

        /* أنماط لعبة الذاكرة (Memory Match) */
        .memory-game {
            width: 100%;
            display: flex;
            flex-direction: column;
            align-items: center;
            margin-bottom: 2rem;
        }
        .memory-game h3 {
            color: #e0f7fa;
            font-size: 1.3rem;
            margin-bottom: 1rem;
        }
        .memory-grid {
            display: grid;
            grid-template-columns: repeat(4, 70px); /* 4 أعمدة */
            grid-template-rows: repeat(4, 70px); /* 4 صفوف */
            gap: 10px;
            background-color: rgba(255, 255, 255, 0.1);
            border-radius: 0.75rem;
            padding: 10px;
            max-width: 320px; /* (70*4) + (10*3) + (10*2) = 280 + 30 + 20 = 330px, adjusted for padding */
        }
        .memory-card {
            width: 70px;
            height: 70px;
            background-color: rgba(255, 255, 255, 0.15);
            border-radius: 0.75rem;
            display: flex;
            justify-content: center;
            align-items: center;
            font-size: 2.5rem;
            cursor: pointer;
            transition: transform 0.3s ease, background-color 0.3s ease;
            transform-style: preserve-3d; /* للحفاظ على ثلاثية الأبعاد عند التقليب */
            position: relative;
        }
        .memory-card.flipped {
            transform: rotateY(180deg);
            background-color: rgba(255, 255, 255, 0.25);
        }
        .memory-card.matched {
            background-color: #81c784; /* لون أخضر للمطابقة */
            cursor: default;
            opacity: 0.8;
        }
        .memory-card .card-face {
            position: absolute;
            width: 100%;
            height: 100%;
            backface-visibility: hidden; /* إخفاء الوجه الخلفي عند عدم التقليب */
            display: flex;
            justify-content: center;
            align-items: center;
        }
        .memory-card .card-front {
            transform: rotateY(180deg); /* الوجه الأمامي يظهر عند التقليب */
        }
        .memory-card .card-back {
            background-color: #7e57c2; /* لون خلفية البطاقة */
            border-radius: 0.75rem;
        }
        .memory-status {
            color: #e0f7fa;
            font-size: 1.1rem;
            margin-top: 1rem;
            min-height: 25px;
        }
        .memory-reset-button {
            background-color: #7e57c2;
            color: white;
            padding: 0.6rem 1.2rem;
            border-radius: 9999px;
            font-size: 1rem;
            font-weight: 700;
            cursor: pointer;
            transition: background-color 0.3s ease, transform 0.2s ease;
            margin-top: 1rem;
            border: none;
        }
        .memory-reset-button:hover {
            background-color: #673ab7;
            transform: translateY(-2px);
        }

        /* أنماط لعبة اضرب الخلد (Whack-a-Mole) */
        .whack-a-mole-game {
            width: 100%;
            display: flex;
            flex-direction: column;
            align-items: center;
            margin-bottom: 2rem;
        }
        .whack-a-mole-game h3 {
            color: #e0f7fa;
            font-size: 1.3rem;
            margin-bottom: 1rem;
        }
        .whack-a-mole-grid {
            display: grid;
            grid-template-columns: repeat(3, 100px); /* 3 أعمدة */
            grid-template-rows: repeat(3, 100px); /* 3 صفوف */
            gap: 15px;
            background-color: rgba(255, 255, 255, 0.1);
            border-radius: 1rem;
            padding: 15px;
            max-width: 360px; /* (100*3) + (15*2) + (15*2) = 300 + 30 + 30 = 360px */
            touch-action: none; /* Prevent scrolling on touch */
        }
        .mole-hole {
            width: 100px;
            height: 100px;
            background-color: rgba(0, 0, 0, 0.3);
            border-radius: 50%; /* شكل دائري للحفرة */
            display: flex;
            justify-content: center;
            align-items: center;
            overflow: hidden;
            position: relative;
            box-shadow: inset 0 0 10px rgba(0, 0, 0, 0.5);
        }
        .mole-emoji {
            font-size: 3.5rem;
            position: absolute;
            bottom: -100%; /* يبدأ مخفيًا تحت الحفرة */
            transition: bottom 0.2s ease-out;
            cursor: pointer;
        }
        .mole-emoji.up {
            bottom: 0; /* يظهر فوق الحفرة */
        }
        .whack-a-mole-controls {
            display: flex;
            gap: 1rem;
            margin-top: 1.5rem;
        }
        .whack-a-mole-button {
            background-color: #f8bbd0;
            color: #332e40;
            padding: 0.75rem 1.5rem;
            border-radius: 9999px;
            font-size: 1.1rem;
            font-weight: 700;
            cursor: pointer;
            transition: background-color 0.3s ease, transform 0.2s ease;
            border: none;
        }
        .whack-a-mole-button:hover {
            background-color: #f48fb1;
            transform: translateY(-2px);
        }
        .whack-a-mole-button:active {
            transform: translateY(0);
        }
        .whack-a-mole-score, .whack-a-mole-time {
            color: #e0f7fa;
            font-size: 1.1rem;
            margin-top: 1rem;
        }

        /* أنماط لعبة فرقعة الفقاعات (Pop the Bubble) */
        .bubble-pop-game {
            width: 100%;
            display: flex;
            flex-direction: column;
            align-items: center;
            margin-bottom: 2rem;
        }
        .bubble-pop-game h3 {
            color: #e0f7fa;
            font-size: 1.3rem;
            margin-bottom: 1rem;
        }
        .bubble-area {
            width: 100%;
            height: 300px; /* Fixed height for the game area */
            background-color: rgba(255, 255, 255, 0.05);
            border-radius: 1rem;
            position: relative;
            overflow: hidden; /* Keep bubbles inside */
            box-shadow: inset 0 0 10px rgba(0, 0, 0, 0.2);
            margin-bottom: 1rem;
            touch-action: none; /* Prevent scrolling on touch */
        }
        .bubble {
            position: absolute;
            background-color: rgba(179, 229, 252, 0.6); /* لون أزرق فاتح وشفاف */
            border-radius: 50%;
            cursor: pointer;
            animation: bubbleFloat 5s linear infinite;
            opacity: 0;
            transform: scale(0);
            transition: transform 0.1s ease-out; /* For pop effect */
            display: flex;
            justify-content: center;
            align-items: center;
            font-size: 1.5rem; /* Emoji size */
            color: #332e40;
            font-weight: bold;
        }
        .bubble:active {
            transform: scale(1.2); /* Pop effect */
        }
        @keyframes bubbleFloat {
            0% { bottom: -20%; opacity: 0; transform: scale(0.5); }
            10% { opacity: 1; transform: scale(1); }
            90% { opacity: 1; transform: scale(1); }
            100% { bottom: 120%; opacity: 0; transform: scale(0.5); }
        }
        .bubble-pop-score, .bubble-pop-time {
            color: #e0f7fa;
            font-size: 1.1rem;
            margin-top: 0.5rem;
        }
        .bubble-pop-controls {
            display: flex;
            gap: 1rem;
            margin-top: 1rem;
        }
        .bubble-pop-button {
            background-color: #b3e5fc;
            color: #332e40;
            padding: 0.75rem 1.5rem;
            border-radius: 9999px;
            font-size: 1.1rem;
            font-weight: 700;
            cursor: pointer;
            transition: background-color 0.3s ease, transform 0.2s ease;
            border: none;
        }
        .bubble-pop-button:hover {
            background-color: #81d4fa;
            transform: translateY(-2px);
        }

        /* أنماط لعبة مطابقة الألوان (Color Match) */
        .color-match-game {
            width: 100%;
            display: flex;
            flex-direction: column;
            align-items: center;
            margin-bottom: 2rem;
        }
        .color-match-game h3 {
            color: #e0f7fa;
            font-size: 1.3rem;
            margin-bottom: 1rem;
        }
        .target-color-display {
            width: 120px;
            height: 120px;
            border-radius: 1rem;
            background-color: #ccc; /* Placeholder */
            margin-bottom: 1.5rem;
            box-shadow: 0 4px 10px rgba(0, 0, 0, 0.3);
            transition: background-color 0.3s ease;
        }
        .color-choices-grid {
            display: grid;
            grid-template-columns: repeat(2, 100px); /* 2 columns */
            gap: 15px;
            margin-bottom: 1.5rem;
            touch-action: none; /* Prevent scrolling on touch */
        }
        .color-choice-button {
            width: 100px;
            height: 100px;
            border-radius: 1rem;
            background-color: #eee; /* Placeholder */
            cursor: pointer;
            transition: transform 0.2s ease, box-shadow 0.2s ease;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
        }
        .color-choice-button:hover {
            transform: translateY(-3px);
            box-shadow: 0 6px 12px rgba(0, 0, 0, 0.3);
        }
        .color-match-message {
            color: #e0f7fa;
            font-size: 1.1rem;
            min-height: 25px;
        }
        .color-match-score {
            color: #e0f7fa;
            font-size: 1.1rem;
            margin-top: 0.5rem;
        }
        .color-match-reset-button {
            background-color: #7e57c2;
            color: white;
            padding: 0.6rem 1.2rem;
            border-radius: 9999px;
            font-size: 1rem;
            font-weight: 700;
            cursor: pointer;
            transition: background-color 0.3s ease, transform 0.2s ease;
            margin-top: 1rem;
            border: none;
        }
        .color-match-reset-button:hover {
            background-color: #673ab7;
            transform: translateY(-2px);
        }

        /* أنماط لعبة التقاط النجوم */
        .catch-stars-game {
            width: 100%;
            display: flex;
            flex-direction: column;
            align-items: center;
            margin-bottom: 2rem;
        }
        .catch-stars-game h3 {
            color: #e0f7fa;
            font-size: 1.3rem;
            margin-bottom: 1rem;
        }
        .stars-area {
            width: 100%;
            height: 300px;
            background-color: rgba(255, 255, 255, 0.05);
            border-radius: 1rem;
            position: relative;
            overflow: hidden;
            box-shadow: inset 0 0 10px rgba(0, 0, 0, 0.2);
            margin-bottom: 1rem;
            touch-action: none; /* Prevent scrolling on touch */
        }
        .falling-star {
            position: absolute;
            font-size: 2.5rem;
            cursor: pointer;
            top: -50px; /* Start above the visible area */
            animation: fall linear infinite;
            opacity: 0;
            transition: transform 0.1s ease-out;
        }
        .falling-star:active {
            transform: scale(1.2);
        }
        @keyframes fall {
            0% { top: -50px; opacity: 1; }
            100% { top: 100%; opacity: 0; }
        }
        .catch-stars-score, .catch-stars-time {
            color: #e0f7fa;
            font-size: 1.1rem;
            margin-top: 0.5rem;
        }
        .catch-stars-controls {
            display: flex;
            gap: 1rem;
            margin-top: 1rem;
        }
        .catch-stars-button {
            background-color: #f8bbd0;
            color: #332e40;
            padding: 0.75rem 1.5rem;
            border-radius: 9999px;
            font-size: 1.1rem;
            font-weight: 700;
            cursor: pointer;
            transition: background-color 0.3s ease, transform 0.2s ease;
            border: none;
        }
        .catch-stars-button:hover {
            background-color: #f48fb1;
            transform: translateY(-2px);
        }

        /* أنماط لوحة الرسم */
        .drawing-pad-game {
            width: 100%;
            display: flex;
            flex-direction: column;
            align-items: center;
            margin-bottom: 2rem;
        }
        .drawing-pad-game h3 {
            color: #e0f7fa;
            font-size: 1.3rem;
            margin-bottom: 1rem;
        }
        .drawing-canvas {
            background-color: white;
            border-radius: 1rem;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.2);
            touch-action: none; /* Prevent scrolling on touch */
            width: 100%; /* Make canvas responsive */
            max-width: 480px; /* Max width for larger screens */
            height: 300px; /* Fixed height, can be adjusted */
            border: 1px solid rgba(255, 255, 255, 0.2);
        }
        .drawing-controls {
            display: flex;
            gap: 1rem;
            margin-top: 1rem;
            flex-wrap: wrap; /* Allow controls to wrap on smaller screens */
            justify-content: center;
        }
        .drawing-controls button {
            background-color: #81c784;
            color: white;
            padding: 0.6rem 1.2rem;
            border-radius: 9999px;
            font-size: 1rem;
            font-weight: 700;
            cursor: pointer;
            transition: background-color 0.3s ease, transform 0.2s ease;
            border: none;
        }
        .drawing-controls button:hover {
            background-color: #66bb6a;
            transform: translateY(-2px);
        }
        .drawing-controls input[type="color"] {
            -webkit-appearance: none;
            -moz-appearance: none;
            appearance: none;
            width: 40px;
            height: 40px;
            background-color: transparent;
            border: none;
            cursor: pointer;
            border-radius: 50%;
            overflow: hidden;
            padding: 0;
        }
        .drawing-controls input[type="color"]::-webkit-color-swatch-wrapper {
            padding: 0;
        }
        .drawing-controls input[type="color"]::-webkit-color-swatch {
            border: none;
            border-radius: 50%;
        }
        .drawing-controls input[type="color"]::-moz-color-swatch-wrapper {
            padding: 0;
        }
        .drawing-controls input[type="color"]::-moz-color-swatch {
            border: none;
            border-radius: 50%;
        }
        .drawing-controls input[type="range"] {
            width: 100px;
            margin: 0 0.5rem;
        }

        /* أنماط لعبة اضرب الرقم */
        .whack-a-number-game {
            width: 100%;
            display: flex;
            flex-direction: column;
            align-items: center;
            margin-bottom: 2rem;
        }
        .whack-a-number-game h3 {
            color: #e0f7fa;
            font-size: 1.3rem;
            margin-bottom: 1rem;
        }
        .whack-a-number-target {
            color: #f8bbd0;
            font-size: 1.5rem;
            font-weight: bold;
            margin-bottom: 1rem;
        }
        .whack-a-number-grid {
            display: grid;
            grid-template-columns: repeat(3, 100px); /* 3 أعمدة */
            grid-template-rows: repeat(3, 100px); /* 3 صفوف */
            gap: 15px;
            background-color: rgba(255, 255, 255, 0.1);
            border-radius: 1rem;
            padding: 15px;
            max-width: 360px;
            touch-action: none; /* Prevent scrolling on touch */
        }
        .number-hole {
            width: 100px;
            height: 100px;
            background-color: rgba(0, 0, 0, 0.3);
            border-radius: 50%;
            display: flex;
            justify-content: center;
            align-items: center;
            overflow: hidden;
            position: relative;
            box-shadow: inset 0 0 10px rgba(0, 0, 0, 0.5);
        }
        .number-display {
            font-size: 3.5rem;
            position: absolute;
            bottom: -100%;
            transition: bottom 0.2s ease-out;
            cursor: pointer;
            color: #e0f7fa;
        }
        .number-display.up {
            bottom: 0;
        }
        .whack-a-number-controls {
            display: flex;
            gap: 1rem;
            margin-top: 1.5rem;
        }
        .whack-a-number-button {
            background-color: #f8bbd0;
            color: #332e40;
            padding: 0.75rem 1.5rem;
            border-radius: 9999px;
            font-size: 1.1rem;
            font-weight: 700;
            cursor: pointer;
            transition: background-color 0.3s ease, transform 0.2s ease;
            border: none;
        }
        .whack-a-number-button:hover {
            background-color: #f48fb1;
            transform: translateY(-2px);
        }
        .whack-a-number-score, .whack-a-number-time {
            color: #e0f7fa;
            font-size: 1.1rem;
            margin-top: 1rem;
        }

        /* أنماط لعبة سرعة البديهة */
        .reaction-game {
            width: 100%;
            display: flex;
            flex-direction: column;
            align-items: center;
            margin-bottom: 2rem;
        }
        .reaction-game h3 {
            color: #e0f7fa;
            font-size: 1.3rem;
            margin-bottom: 1rem;
        }
        .reaction-button {
            width: 150px;
            height: 150px;
            background-color: #ccc; /* Default color */
            border-radius: 1rem;
            display: flex;
            justify-content: center;
            align-items: center;
            font-size: 1.5rem;
            font-weight: bold;
            color: #332e40;
            cursor: pointer;
            transition: background-color 0.1s ease-in-out;
            box-shadow: 0 4px 10px rgba(0, 0, 0, 0.3);
            margin-bottom: 1rem;
            touch-action: none; /* Prevent scrolling on touch */
        }
        .reaction-button.ready {
            background-color: #FFD700; /* Gold */
        }
        .reaction-button.go {
            background-color: #32CD32; /* LimeGreen */
        }
        .reaction-message {
            color: #e0f7fa;
            font-size: 1.1rem;
            min-height: 25px;
        }
        .reaction-time-display {
            color: #f8bbd0;
            font-size: 1.3rem;
            font-weight: bold;
            margin-top: 0.5rem;
        }
        .reaction-controls {
            display: flex;
            gap: 1rem;
            margin-top: 1rem;
        }
        .reaction-controls button {
            background-color: #7e57c2;
            color: white;
            padding: 0.6rem 1.2rem;
            border-radius: 9999px;
            font-size: 1rem;
            font-weight: 700;
            cursor: pointer;
            transition: background-color 0.3s ease, transform 0.2s ease;
            border: none;
        }
        .reaction-controls button:hover {
            background-color: #673ab7;
            transform: translateY(-2px);
        }

        /* أنماط لعبة تسلسل الذاكرة */
        .memory-sequence-game {
            width: 100%;
            display: flex;
            flex-direction: column;
            align-items: center;
            margin-bottom: 2rem;
        }
        .memory-sequence-game h3 {
            color: #e0f7fa;
            font-size: 1.3rem;
            margin-bottom: 1rem;
        }
        .sequence-buttons {
            display: grid;
            grid-template-columns: repeat(2, 100px);
            grid-template-rows: repeat(2, 100px);
            gap: 15px;
            background-color: rgba(255, 255, 255, 0.1);
            border-radius: 1rem;
            padding: 15px;
            max-width: 230px; /* (100*2) + (15*1) + (15*2) = 200 + 15 + 30 = 245px, adjusted */
            touch-action: none; /* Prevent scrolling on touch */
        }
        .sequence-button {
            width: 100px;
            height: 100px;
            border-radius: 1rem;
            background-color: #ccc; /* Default color */
            cursor: pointer;
            transition: background-color 0.2s ease, transform 0.1s ease;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
        }
        .sequence-button.highlight {
            filter: brightness(1.5);
            transform: scale(1.05);
        }
        .sequence-button:active {
            transform: scale(0.95);
        }
        .sequence-status {
            color: #e0f7fa;
            font-size: 1.1rem;
            margin-top: 1rem;
            min-height: 25px;
        }
        .sequence-controls {
            display: flex;
            gap: 1rem;
            margin-top: 1rem;
        }
        .sequence-controls button {
            background-color: #f8bbd0;
            color: #332e40;
            padding: 0.75rem 1.5rem;
            border-radius: 9999px;
            font-size: 1.1rem;
            font-weight: 700;
            cursor: pointer;
            transition: background-color 0.3s ease, transform 0.2s ease;
            border: none;
        }
        .sequence-controls button:hover {
            background-color: #f48fb1;
            transform: translateY(-2px);
        }

        /* New Game: Match 3 (Candy Crush-like) */
        .match3-game {
            width: 100%;
            display: flex;
            flex-direction: column;
            align-items: center;
            margin-bottom: 2rem;
        }
        .match3-game h3 {
            color: #e0f7fa;
            font-size: 1.3rem;
            margin-bottom: 1rem;
        }
        .match3-grid-container {
            display: grid;
            grid-template-columns: repeat(8, 40px); /* 8x8 grid */
            grid-template-rows: repeat(8, 40px);
            gap: 2px;
            background-color: rgba(255, 255, 255, 0.1);
            border-radius: 0.5rem;
            padding: 5px;
            max-width: calc(8 * 40px + 7 * 2px + 10px); /* Adjust for gap and padding */
            touch-action: none; /* Prevent scrolling on touch */
        }
        .match3-cell {
            width: 40px;
            height: 40px;
            background-color: rgba(255, 255, 255, 0.15);
            border-radius: 0.3rem;
            display: flex;
            justify-content: center;
            align-items: center;
            font-size: 1.8rem;
            cursor: grab;
            transition: transform 0.1s ease-out;
            user-select: none; /* Prevent text selection */
        }
        .match3-cell.dragging {
            opacity: 0.7;
            transform: scale(1.1);
        }
        .match3-cell.matched {
            animation: fadeOut 0.5s forwards;
        }
        @keyframes fadeOut {
            from { opacity: 1; transform: scale(1); }
            to { opacity: 0; transform: scale(0); }
        }
        .match3-score, .match3-moves {
            color: #e0f7fa;
            font-size: 1.1rem;
            margin-top: 1rem;
        }
        .match3-controls {
            display: flex;
            gap: 1rem;
            margin-top: 1rem;
        }
        .match3-button {
            background-color: #f8bbd0;
            color: #332e40;
            padding: 0.75rem 1.5rem;
            border-radius: 9999px;
            font-size: 1.1rem;
            font-weight: 700;
            cursor: pointer;
            transition: background-color 0.3s ease, transform 0.2s ease;
            border: none;
        }
        .match3-button:hover {
            background-color: #f48fb1;
            transform: translateY(-2px);
        }

        /* New Game: Drag and Drop Sorting */
        .sorting-game {
            width: 100%;
            display: flex;
            flex-direction: column;
            align-items: center;
            margin-bottom: 2rem;
        }
        .sorting-game h3 {
            color: #e0f7fa;
            font-size: 1.3rem;
            margin-bottom: 1rem;
        }
        .sorting-items-container {
            display: flex;
            flex-wrap: wrap;
            gap: 1rem;
            justify-content: center;
            margin-bottom: 1.5rem;
            touch-action: none; /* Prevent scrolling on touch */
        }
        .draggable-item {
            background-color: #b3e5fc;
            color: #332e40;
            padding: 0.8rem 1.2rem;
            border-radius: 0.75rem;
            font-size: 1.5rem;
            cursor: grab;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
            transition: transform 0.2s ease;
        }
        .draggable-item:hover {
            transform: translateY(-3px);
        }
        .drop-zones-container {
            display: flex;
            gap: 1.5rem;
            flex-wrap: wrap;
            justify-content: center;
            touch-action: none; /* Prevent scrolling on touch */
        }
        .drop-zone {
            background-color: rgba(255, 255, 255, 0.1);
            border: 2px dashed #e0f7fa;
            border-radius: 1rem;
            padding: 1.5rem;
            min-width: 150px;
            min-height: 100px;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            color: #e0f7fa;
            font-size: 1.2rem;
            font-weight: bold;
            transition: background-color 0.2s ease, border-color 0.2s ease;
        }
        .drop-zone.drag-over {
            background-color: rgba(255, 255, 255, 0.2);
            border-color: #f8bbd0;
        }
        .sorting-message {
            color: #e0f7fa;
            font-size: 1.1rem;
            margin-top: 1rem;
            min-height: 25px;
        }
        .sorting-score {
            color: #e0f7fa;
            font-size: 1.1rem;
            margin-top: 0.5rem;
        }
        .sorting-button {
            background-color: #7e57c2;
            color: white;
            padding: 0.75rem 1.5rem;
            border-radius: 9999px;
            font-size: 1.1rem;
            font-weight: 700;
            cursor: pointer;
            transition: background-color 0.3s ease, transform 0.2s ease;
            border: none;
            margin-top: 1rem;
        }
        .sorting-button:hover {
            background-color: #673ab7;
            transform: translateY(-2px);
        }

        /* New Game: Quick Click */
        .quick-click-game {
            width: 100%;
            display: flex;
            flex-direction: column;
            align-items: center;
            margin-bottom: 2rem;
        }
        .quick-click-game h3 {
            color: #e0f7fa;
            font-size: 1.3rem;
            margin-bottom: 1rem;
        }
        .click-area {
            width: 100%;
            height: 300px;
            background-color: rgba(255, 255, 255, 0.05);
            border-radius: 1rem;
            position: relative;
            overflow: hidden;
            box-shadow: inset 0 0 10px rgba(0, 0, 0, 0.2);
            margin-bottom: 1rem;
            touch-action: none; /* Prevent scrolling on touch */
        }
        .target-button {
            position: absolute;
            background-color: #f8bbd0;
            color: #332e40;
            width: 80px;
            height: 80px;
            border-radius: 50%;
            display: flex;
            justify-content: center;
            align-items: center;
            font-size: 2.5rem;
            font-weight: bold;
            cursor: pointer;
            transition: transform 0.1s ease-out, background-color 0.2s ease;
            box-shadow: 0 4px 10px rgba(0, 0, 0, 0.3);
        }
        .target-button:active {
            transform: scale(0.9);
        }
        .quick-click-score, .quick-click-time {
            color: #e0f7fa;
            font-size: 1.1rem;
            margin-top: 0.5rem;
        }
        .quick-click-controls {
            display: flex;
            gap: 1rem;
            margin-top: 1rem;
        }
        .quick-click-button {
            background-color: #b3e5fc;
            color: #332e40;
            padding: 0.75rem 1.5rem;
            border-radius: 9999px;
            font-size: 1.1rem;
            font-weight: 700;
            cursor: pointer;
            transition: background-color 0.3s ease, transform 0.2s ease;
            border: none;
        }
        .quick-click-button:hover {
            background-color: #81d4fa;
            transform: translateY(-2px);
        }

        /* New Game: Maze Game */
        .maze-game {
            width: 100%;
            display: flex;
            flex-direction: column;
            align-items: center;
            margin-bottom: 2rem;
        }
        .maze-game h3 {
            color: #e0f7fa;
            font-size: 1.3rem;
            margin-bottom: 1rem;
        }
        .maze-canvas {
            background-color: #221c27;
            border-radius: 1rem;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.2);
            touch-action: none; /* Prevent scrolling on touch */
            width: 100%;
            max-width: 480px;
            height: 300px;
            border: 1px solid rgba(255, 255, 255, 0.2);
        }
        .maze-message {
            color: #e0f7fa;
            font-size: 1.1rem;
            margin-top: 1rem;
            min-height: 25px;
        }
        .maze-controls {
            display: flex;
            gap: 1rem;
            margin-top: 1rem;
        }
        .maze-button {
            background-color: #81c784;
            color: white;
            padding: 0.75rem 1.5rem;
            border-radius: 9999px;
            font-size: 1.1rem;
            font-weight: 700;
            cursor: pointer;
            transition: background-color 0.3s ease, transform 0.2s ease;
            border: none;
        }
        .maze-button:hover {
            background-color: #66bb6a;
            transform: translateY(-2px);
        }

        /* Show Games Button */
        #showGamesButton {
            background-color: #b3e5fc;
            color: #332e40;
            padding: 1rem 2rem;
            border-radius: 9999px;
            font-size: 1.5rem;
            font-weight: 700;
            cursor: pointer;
            transition: background-color 0.3s ease, transform 0.2s ease;
            margin-top: 2.5rem;
            border: none;
            display: flex;
            align-items: center;
            justify-content: center;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.3);
        }
        #showGamesButton:hover {
            background-color: #81d4fa;
            transform: translateY(-3px);
        }
        #showGamesButton:active {
            transform: translateY(0);
        }

        /* Princess Message */
        #princessMessage {
            color: #f8bbd0;
            font-size: 1.8rem;
            font-weight: 700;
            margin-top: 2rem;
            margin-bottom: 1.5rem;
            text-shadow: 0 0 10px rgba(248, 187, 208, 0.7);
            animation: fadeIn 1s ease-out;
        }
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }


        /* تعديلات التصميم المتجاوب للشاشات الأصغر (الموبايل والتابلت) */
        @media (max-width: 768px) {
            .text-jojo {
                font-size: 1.8rem;
            }
            .text-jojo-sub {
                font-size: 1.2rem;
            }
            .zzz-icon {
                font-size: 1.5rem;
            }
            .container {
                padding: 1.5rem;
                border-radius: 1.5rem;
            }
            .play-button {
                padding: 0.8rem 1.5rem;
                font-size: 1.2rem;
            }
            .play-icon {
                font-size: 1.5rem;
            }
            /* تقليل أحجام القلوب على الشاشات الصغيرة */
            .heart-shape:nth-child(1) { width: 50px; height: 50px; }
            .heart-shape:nth-child(2) { width: 70px; height: 70px; }
            .heart-shape:nth-child(3) { width: 30px; height: 30px; }
            .heart-shape:nth-child(4) { width: 60px; height: 60px; }
            .heart-shape:nth-child(5) { width: 40px; height: 40px; }
            .heart-shape:nth-child(6) { width: 25px; height: 25px; }
            .heart-shape:nth-child(7) { width: 55px; height: 55px; }
            .heart-shape:nth-child(8) { width: 65px; height: 65px; }
            .heart-shape:nth-child(9) { width: 45px; height: 45px; }

            .gemini-feature-section {
                padding: 1rem;
                margin-top: 2rem;
            }
            .gemini-feature-section textarea,
            .gemini-feature-section input[type="text"] {
                font-size: 0.9rem;
            }
            .gemini-feature-section button {
                font-size: 1rem;
                padding: 0.6rem 1.2rem;
            }
            .gemini-output {
                font-size: 0.9rem;
            }
            .listen-button {
                font-size: 1rem;
                padding: 0.6rem 1.2rem;
            }

            /* تعديلات الألعاب على الشاشات الصغيرة */
            .games-section {
                padding: 1rem;
                margin-top: 2rem;
            }
            .games-section h2 {
                font-size: 1.5rem;
            }
            .tic-tac-toe-board {
                grid-template-columns: repeat(3, 60px);
                grid-template-rows: repeat(3, 60px);
            }
            .tic-tac-toe-cell {
                width: 60px;
                height: 60px;
                font-size: 2.2rem;
            }
            .rps-choice-button {
                padding: 0.8rem 1.2rem;
                font-size: 1.5rem;
            }
            .rps-result {
                font-size: 1rem;
            }
            .guess-number-game input[type="number"] {
                width: 80px;
                font-size: 1rem;
            }
            .guess-number-game button {
                font-size: 1rem;
                padding: 0.6rem 1.2rem;
            }
            .guess-number-game .message {
                font-size: 0.9rem;
            }
            /* Memory Game adjustments */
            .memory-grid {
                grid-template-columns: repeat(4, 55px);
                grid-template-rows: repeat(4, 55px);
                gap: 8px;
                max-width: 260px; /* (55*4) + (8*3) + (8*2) = 220 + 24 + 16 = 260px */
            }
            .memory-card {
                width: 55px;
                height: 55px;
                font-size: 2rem;
            }
            /* Whack-a-Mole adjustments */
            .whack-a-mole-grid {
                grid-template-columns: repeat(3, 80px);
                grid-template-rows: repeat(3, 80px);
                gap: 10px;
                max-width: 270px; /* (80*3) + (10*2) + (10*2) = 240 + 20 + 20 = 280px */
            }
            .mole-hole {
                width: 80px;
                height: 80px;
            }
            .mole-emoji {
                font-size: 2.8rem;
            }
            .whack-a-mole-button {
                font-size: 1rem;
                padding: 0.6rem 1.2rem;
            }
            .whack-a-mole-score, .whack-a-mole-time {
                font-size: 1rem;
            }
            /* Bubble Pop adjustments */
            .bubble-area {
                height: 250px;
            }
            .bubble {
                font-size: 1.2rem;
            }
            .bubble-pop-button {
                font-size: 1rem;
                padding: 0.6rem 1.2rem;
            }
            /* Color Match adjustments */
            .target-color-display {
                width: 100px;
                height: 100px;
            }
            .color-choices-grid {
                grid-template-columns: repeat(2, 80px);
                gap: 10px;
            }
            .color-choice-button {
                width: 80px;
                height: 80px;
            }
            /* Catch Stars adjustments */
            .stars-area {
                height: 250px;
            }
            .falling-star {
                font-size: 2rem;
            }
            .catch-stars-button {
                font-size: 1rem;
                padding: 0.6rem 1.2rem;
            }
            /* Drawing Pad adjustments */
            .drawing-canvas {
                height: 250px;
            }
            .drawing-controls button {
                font-size: 0.9rem;
                padding: 0.5rem 1rem;
            }
            .drawing-controls input[type="color"] {
                width: 30px;
                height: 30px;
            }
            .drawing-controls input[type="range"] {
                width: 80px;
            }
            /* Whack-a-Number adjustments */
            .whack-a-number-target {
                font-size: 1.2rem;
            }
            .whack-a-number-grid {
                grid-template-columns: repeat(3, 80px);
                grid-template-rows: repeat(3, 80px);
                gap: 10px;
                max-width: 270px;
            }
            .number-hole {
                width: 80px;
                height: 80px;
            }
            .number-display {
                font-size: 2.8rem;
            }
            .whack-a-number-button {
                font-size: 1rem;
                padding: 0.6rem 1.2rem;
            }
            /* Reaction Time adjustments */
            .reaction-button {
                width: 120px;
                height: 120px;
                font-size: 1.2rem;
            }
            .reaction-time-display {
                font-size: 1.1rem;
            }
            .reaction-controls button {
                font-size: 1rem;
                padding: 0.6rem 1.2rem;
            }
            /* Memory Sequence adjustments */
            .sequence-buttons {
                grid-template-columns: repeat(2, 80px);
                grid-template-rows: repeat(2, 80px);
                gap: 10px;
                max-width: 190px;
            }
            .sequence-button {
                width: 80px;
                height: 80px;
            }
            .sequence-controls button {
                font-size: 1rem;
                padding: 0.6rem 1.2rem;
            }
            /* Match 3 adjustments */
            .match3-grid-container {
                grid-template-columns: repeat(8, 35px);
                grid-template-rows: repeat(8, 35px);
                max-width: calc(8 * 35px + 7 * 2px + 10px);
            }
            .match3-cell {
                width: 35px;
                height: 35px;
                font-size: 1.5rem;
            }
            .match3-button {
                font-size: 1rem;
                padding: 0.6rem 1.2rem;
            }
            /* Sorting Game adjustments */
            .draggable-item {
                font-size: 1.2rem;
                padding: 0.6rem 1rem;
            }
            .drop-zone {
                min-width: 120px;
                min-height: 80px;
                font-size: 1rem;
                padding: 1rem;
            }
            .sorting-button {
                font-size: 1rem;
                padding: 0.6rem 1.2rem;
            }

            #showGamesButton {
                font-size: 1.2rem;
                padding: 0.8rem 1.5rem;
            }
            #princessMessage {
                font-size: 1.5rem;
            }
            .footer {
                font-size: 1rem;
            }
            .footer .heart-icon-footer {
                font-size: 1.2rem;
            }
        }
        /* تعديلات التصميم المتجاوب للشاشات الأصغر جداً (الهواتف) */
        @media (max-width: 480px) {
            .text-jojo {
                font-size: 1.5rem;
            }
            .text-jojo-sub {
                font-size: 1rem;
            }
            .zzz-icon {
                font-size: 1.2rem;
            }
            .container {
                padding: 1rem;
                border-radius: 1rem;
            }
            /* إخفاء القلوب على الشاشات الصغيرة جداً لتجنب الازدحام الشديد */
            .heart-shape {
                display: none;
            }
            .gemini-feature-section {
                padding: 0.8rem;
                margin-top: 1.5rem;
            }
            /* تقليل حجم خلايا X-O أكثر */
            .tic-tac-toe-board {
                grid-template-columns: repeat(3, 50px);
                grid-template-rows: repeat(3, 50px);
            }
            .tic-tac-toe-cell {
                width: 50px;
                height: 50px;
                font-size: 1.8rem;
            }
            .rps-choices {
                flex-direction: column; /* جعل الأزرار عمودية على الشاشات الصغيرة جداً */
                gap: 0.8rem;
            }
            /* Memory Game adjustments for very small screens */
            .memory-grid {
                grid-template-columns: repeat(4, 45px);
                grid-template-rows: repeat(4, 45px);
                gap: 5px;
                max-width: 200px; /* (45*4) + (5*3) + (5*2) = 180 + 15 + 10 = 205px */
            }
            .memory-card {
                width: 45px;
                height: 45px;
                font-size: 1.8rem;
            }
            /* Whack-a-Mole adjustments for very small screens */
            .whack-a-mole-grid {
                grid-template-columns: repeat(3, 60px);
                grid-template-rows: repeat(3, 60px);
                gap: 8px;
                max-width: 200px; /* (60*3) + (8*2) + (8*2) = 180 + 16 + 16 = 212px */
            }
            .mole-hole {
                width: 60px;
                height: 60px;
            }
            .mole-emoji {
                font-size: 2.2rem;
            }
            /* Bubble Pop adjustments */
            .bubble-area {
                height: 200px;
            }
            .bubble {
                font-size: 1rem;
            }
            /* Catch Stars adjustments */
            .stars-area {
                height: 200px;
            }
            .falling-star {
                font-size: 1.8rem;
            }
            /* Drawing Pad adjustments */
            .drawing-canvas {
                height: 200px;
            }
            /* Whack-a-Number adjustments */
            .whack-a-number-grid {
                grid-template-columns: repeat(3, 60px);
                grid-template-rows: repeat(3, 60px);
                gap: 8px;
                max-width: 200px;
            }
            .number-hole {
                width: 60px;
                height: 60px;
            }
            .number-display {
                font-size: 2.2rem;
            }
            /* Reaction Time adjustments */
            .reaction-button {
                width: 100px;
                height: 100px;
                font-size: 1rem;
            }
            /* Memory Sequence adjustments */
            .sequence-buttons {
                grid-template-columns: repeat(2, 60px);
                grid-template-rows: repeat(2, 60px);
                gap: 8px;
                max-width: 140px;
            }
            .sequence-button {
                width: 60px;
                height: 60px;
            }
            /* Match 3 adjustments */
            .match3-grid-container {
                grid-template-columns: repeat(8, 30px);
                grid-template-rows: repeat(8, 30px);
                max-width: calc(8 * 30px + 7 * 2px + 10px);
            }
            .match3-cell {
                width: 30px;
                height: 30px;
                font-size: 1.2rem;
            }
            /* Sorting Game adjustments */
            .draggable-item {
                font-size: 1rem;
                padding: 0.5rem 0.8rem;
            }
            .drop-zone {
                min-width: 100px;
                min-height: 70px;
                font-size: 0.9rem;
                padding: 0.8rem;
            }
            #showGamesButton {
                font-size: 1rem;
                padding: 0.6rem 1.2rem;
            }
            #princessMessage {
                font-size: 1.2rem;
            }
            .footer {
                font-size: 0.9rem;
            }
            .footer .heart-icon-footer {
                font-size: 1.1rem;
            }
        }
    </style>
</head>
<body>
    <div class="heart-shape" style="top: 10%; left: 15%; --rotation: -20deg;"></div>
    <div class="heart-shape" style="bottom: 5%; right: 10%; --rotation: 30deg;"></div>
    <div class="heart-shape" style="top: 50%; left: 5%; --rotation: 10deg;"></div>
    <div class="heart-shape" style="top: 20%; right: 25%; --rotation: -40deg;"></div>
    <div class="heart-shape" style="bottom: 20%; left: 30%; --rotation: 50deg;"></div>
    <div class="heart-shape" style="top: 40%; right: 5%; --rotation: -10deg;"></div>
    <div class="heart-shape" style="top: 70%; left: 18%; --rotation: 15deg;"></div>
    <div class="heart-shape" style="top: 5%; right: 50%; --rotation: -35deg;"></div>
    <div class="heart-shape" style="bottom: 10%; left: 45%; --rotation: 25deg;"></div>

    <div class="container">
        <h1 class="text-jojo">
            هذا الموقع صُمّم خصيصًا لجوجو <span class="heart-icon">❤️</span>
        </h1>
        <p class="text-jojo-sub">
            نوم العوافي <span class="zzz-icon">Zzz</span>
        </p>

        <div id="audioPrompt" class="flex flex-col items-center justify-center">
            <p class="text-gray-300 text-lg mb-4">اضغط هنا لتشغيل أغنية براعم!</p>
            <button id="playButton" class="play-button">
                تشغيل الأغنية
                <svg class="play-icon" fill="currentColor" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg">
                    <path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zM9.555 7.168A1 1 0 008 8v4a1 1 0 001.555.832l3-2a1 1 0 000-1.664l-3-2z" clip-rule="evenodd"></path>
                </svg>
            </button>
            <p id="errorMessage" class="text-red-400 text-sm mt-2 hidden">
                عذراً، فشل تشغيل الأغنية. يرجى التأكد من أن رابط الأغنية صحيح ومباشر (ينتهي بـ .mp3).
            </p>
        </div>

        <audio id="baraemAudio" loop>
            <source src="https://archive.org/download/baraem-song/baraem-song.mp3" type="audio/mpeg">
            متصفحك لا يدعم تشغيل الصوت.
        </audio>

        <div class="gemini-feature-section">
            <h2 class="text-pink-200 mb-4">✨ تأليف القصص لجوجو ✨</h2>
            <textarea id="storyPromptInput" placeholder="اكتب فكرة القصة هنا (مثلاً: عن أرنب صغير، نجمة تلمع)"></textarea>
            <button id="generateStoryButton">
                تأليف القصة ✨
            </button>
            <div id="storyLoadingIndicator" class="loading-indicator hidden">
                <div class="spinner"></div>
                <span class="mr-2">جاري تأليف القصة...</span>
            </div>
            <div id="storyOutput" class="gemini-output hidden"></div>
            <button id="listenStoryButton" class="listen-button hidden">
                استمع للقصة
                <svg class="listen-icon w-5 h-5" fill="currentColor" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg">
                    <path fill-rule="evenodd" d="M9.383 3.076A1 1 0 0110 4v12a1 1 0 01-1.707.707L4.586 13H2a1 1 0 01-1-1V8a1 1 0 011-1h2.586l3.707-3.707a1 1 0 011.09-.217zM14.616 3.89a1 1 0 011.768 0 1 1 0 010 1.768l-1.768 1.768a1 1 0 01-1.768 0 1 1 0 010-1.768l2.5-2.5a1 1 0 010-1.414zM16.03 7.303a1 1 0 011.414 0 1 1 0 010 1.414L14.414 11l3.03 3.03a1 1 0 01-1.414 1.414L13 12.414l-3.03 3.03a1 1 0 01-1.414-1.414L11.586 11l-3.03-3.03a1 1 0 010-1.414 1 1 0 011.414 0L13 9.586l3.03-3.03z" clip-rule="evenodd"></path>
                </svg>
            </button>
        </div>

        <button id="showGamesButton">طفشانة؟ ودك العاب تسليك؟</button>
        <p id="princessMessage" class="hidden">ابشري يالأميرة! تفضلي الألعاب:</p>

        <div id="gamesSectionWrapper" class="games-section hidden">
            <h2 class="text-blue-200 mb-4">🎮 ألعاب جوجو 🎮</h2>

            <div class="match3-game">
                <h3>لعبة مطابقة الرموز (كاندي كراش) 🍬</h3>
                <p class="match3-score">النقاط: 0</p>
                <p class="match3-moves">الحركات المتبقية: 20</p>
                <div id="match3Grid" class="match3-grid-container"></div>
                <div class="match3-controls">
                    <button id="match3StartButton" class="match3-button">ابدا اللعبة</button>
                    <button id="match3ResetButton" class="match3-button hidden">إعادة اللعبة</button>
                </div>
            </div>

            <div class="sorting-game">
                <h3>لعبة التصنيف 📦</h3>
                <p class="sorting-score">النقاط: 0</p>
                <div id="sortingItems" class="sorting-items-container"></div>
                <div class="drop-zones-container">
                    <div class="drop-zone" data-category="fruits">فواكه 🍎</div>
                    <div class="drop-zone" data-category="animals">حيوانات 🦁</div>
                    <div class="drop-zone" data-category="vehicles">مركبات 🚗</div>
                </div>
                <p class="sorting-message"></p>
                <button id="sortingResetButton" class="sorting-button">إعادة اللعبة</button>
            </div>

            <div class="quick-click-game">
                <h3>لعبة الضغط السريع 🚀</h3>
                <p class="quick-click-score">النقاط: 0</p>
                <p class="quick-click-time">الوقت: 15 ثانية</p>
                <div id="clickArea" class="click-area">
                    <button id="targetButton" class="target-button hidden">اضغط!</button>
                </div>
                <div class="quick-click-controls">
                    <button id="quickClickStartButton" class="quick-click-button">ابدا اللعبة</button>
                    <button id="quickClickResetButton" class="quick-click-button hidden">إعادة اللعبة</button>
                </div>
            </div>

            <div class="maze-game">
                <h3>لعبة المتاهة 🗺️</h3>
                <canvas id="mazeCanvas" class="maze-canvas"></canvas>
                <p class="maze-message">استخدم الأسهم أو اسحب للتحرك</p>
                <div class="maze-controls">
                    <button id="mazeResetButton" class="maze-button">إعادة اللعبة</button>
                </div>
            </div>

            <div class="tic-tac-toe-game">
                <h3>لعبة إكس أو</h3>
                <div id="ticTacToeBoard" class="tic-tac-toe-board">
                    <div class="tic-tac-toe-cell" data-cell-index="0"></div>
                    <div class="tic-tac-toe-cell" data-cell-index="1"></div>
                    <div class="tic-tac-toe-cell" data-cell-index="2"></div>
                    <div class="tic-tac-toe-cell" data-cell-index="3"></div>
                    <div class="tic-tac-toe-cell" data-cell-index="4"></div>
                    <div class="tic-tac-toe-cell" data-cell-index="5"></div>
                    <div class="tic-tac-toe-cell" data-cell-index="6"></div>
                    <div class="tic-tac-toe-cell" data-cell-index="7"></div>
                    <div class="tic-tac-toe-cell" data-cell-index="8"></div>
                </div>
                <p id="ticTacToeStatus" class="text-e0f7fa mt-4 text-lg font-semibold">دور اللاعب X</p>
                <button id="ticTacToeResetButton" class="tic-tac-toe-reset-button">إعادة اللعبة</button>
            </div>

            <div class="rps-game">
                <h3>لعبة حجر ورقة مقص</h3>
                <div class="rps-choices">
                    <button class="rps-choice-button" data-choice="rock">✊</button>
                    <button class="rps-choice-button" data-choice="paper">✋</button>
                    <button class="rps-choice-button" data-choice="scissors">✌️</button>
                </div>
                <p id="rpsResult" class="rps-result"></p>
            </div>

            <div class="guess-number-game">
                <h3>لعبة تخمين الرقم 🔢</h3>
                <p class="text-e0f7fa mb-2">خمن رقم بين 1 و 100.</p>
                <input type="number" id="guessInput" min="1" max="100" placeholder="أدخل تخمينك">
                <button id="guessButton">خمن</button>
                <p id="guessMessage" class="message"></p>
                <p id="guessCount" class="text-e0f7fa text-sm mt-1">المحاولات: 0</p>
                <button id="guessResetButton" class="reset-button">إعادة اللعبة</button>
            </div>

            <div class="memory-game">
                <h3>لعبة الذاكرة 🧠</h3>
                <p class="memory-status">محاولات: 0 | أزواج صحيحة: 0</p>
                <div id="memoryGrid" class="memory-grid">
                    </div>
                <button id="memoryResetButton" class="memory-reset-button">إعادة اللعبة</button>
            </div>

            <div class="whack-a-mole-game">
                <h3>لعبة اضرب الرموز 💥</h3>
                <p class="whack-a-mole-score">النقاط: 0</p>
                <p class="whack-a-mole-time">الوقت: 30 ثانية</p>
                <div id="whackAMoleGrid" class="whack-a-mole-grid">
                    </div>
                <div class="whack-a-mole-controls">
                    <button id="whackAMoleStartButton" class="whack-a-mole-button">ابدا اللعبة</button>
                    <button id="whackAMoleResetButton" class="whack-a-mole-button hidden">إعادة اللعبة</button>
                </div>
            </div>

            <div class="bubble-pop-game">
                <h3>لعبة فرقعة الفقاعات 🫧</h3>
                <p class="bubble-pop-score">النقاط: 0</p>
                <p class="bubble-pop-time">الوقت: 20 ثانية</p>
                <div id="bubbleArea" class="bubble-area">
                    </div>
                <div class="bubble-pop-controls">
                    <button id="bubblePopStartButton" class="bubble-pop-button">ابدا اللعبة</button>
                    <button id="bubblePopResetButton" class="bubble-pop-button hidden">إعادة اللعبة</button>
                </div>
            </div>

            <div class="color-match-game">
                <h3>لعبة مطابقة الألوان 🎨</h3>
                <p class="color-match-score">النقاط: 0</p>
                <div class="target-color-display" id="targetColorDisplay"></div>
                <div class="color-choices-grid" id="colorChoicesGrid">
                    </div>
                <p class="color-match-message" id="colorMatchMessage"></p>
                <button id="colorMatchResetButton" class="color-match-reset-button">إعادة اللعبة</button>
            </div>

            <div class="catch-stars-game">
                <h3>التقط النجوم ✨</h3>
                <p class="catch-stars-score">النقاط: 0</p>
                <p class="catch-stars-time">الوقت: 20 ثانية</p>
                <div id="starsArea" class="stars-area">
                    </div>
                <div class="catch-stars-controls">
                    <button id="catchStarsStartButton" class="catch-stars-button">ابدا اللعبة</button>
                    <button id="catchStarsResetButton" class="catch-stars-button hidden">إعادة اللعبة</button>
                </div>
            </div>

            <div class="drawing-pad-game">
                <h3>لوحة الرسم 🖌️</h3>
                <canvas id="drawingCanvas" class="drawing-canvas"></canvas>
                <div class="drawing-controls">
                    <input type="color" id="colorPicker" value="#f8bbd0">
                    <input type="range" id="brushSize" min="1" max="10" value="3">
                    <button id="clearCanvasButton">مسح الكل</button>
                </div>
            </div>

            <div class="whack-a-number-game">
                <h3>اضرب الرقم 🔢</h3>
                <p class="whack-a-number-target">اضغط على الرقم: <span id="whackANumberTarget"></span></p>
                <p class="whack-a-number-score">النقاط: 0</p>
                <p class="whack-a-number-time">الوقت: 30 ثانية</p>
                <div id="whackANumberGrid" class="whack-a-number-grid">
                    </div>
                <div class="whack-a-number-controls">
                    <button id="whackANumberStartButton" class="whack-a-number-button">ابدا اللعبة</button>
                    <button id="whackANumberResetButton" class="whack-a-number-button hidden">إعادة اللعبة</button>
                </div>
            </div>

            <div class="reaction-game">
                <h3>لعبة سرعة البديهة ⚡</h3>
                <div id="reactionButton" class="reaction-button">اضغط للبدء</div>
                <p id="reactionMessage" class="reaction-message"></p>
                <p id="reactionTimeDisplay" class="reaction-time-display"></p>
                <div class="reaction-controls">
                    <button id="reactionStartButton">ابدا اللعبة</button>
                    <button id="reactionResetButton" class="hidden">إعادة اللعبة</button>
                </div>
            </div>

            <div class="memory-sequence-game">
                <h3>لعبة تسلسل الذاكرة 💡</h3>
                <p class="sequence-status">المستوى: 1</p>
                <div id="sequenceButtons" class="sequence-buttons">
                    <button class="sequence-button" data-color="red" style="background-color: #EF5350;"></button>
                    <button class="sequence-button" data-color="green" style="background-color: #66BB6A;"></button>
                    <button class="sequence-button" data-color="blue" style="background-color: #42A5F5;"></button>
                    <button class="sequence-button" data-color="yellow" style="background-color: #FFCA28;"></button>
                </div>
                <div class="sequence-controls">
                    <button id="sequenceStartButton">ابدا اللعبة</button>
                    <button id="sequenceResetButton" class="hidden">إعادة اللعبة</button>
                </div>
            </div>

        </div>

    </div>

    <div class="footer">
        صنع بحب من أجلك <span class="heart-icon-footer">❤️</span>
    </div>

    <script>
        // Get references to audio elements and buttons
        const audio = document.getElementById('baraemAudio');
        const playButton = document.getElementById('playButton');
        const audioPrompt = document.getElementById('audioPrompt');
        const errorMessage = document.getElementById('errorMessage');

        // Get references to story generator elements
        const storyPromptInput = document.getElementById('storyPromptInput');
        const generateStoryButton = document.getElementById('generateStoryButton');
        const storyLoadingIndicator = document.getElementById('storyLoadingIndicator');
        const storyOutput = document.getElementById('storyOutput');
        const listenStoryButton = document.getElementById('listenStoryButton');

        // Get references to games section and show games button
        const showGamesButton = document.getElementById('showGamesButton');
        const princessMessage = document.getElementById('princessMessage');
        const gamesSectionWrapper = document.getElementById('gamesSectionWrapper');

        // Event listener for playing the audio
        playButton.addEventListener('click', () => {
            audio.play()
                .then(() => {
                    audioPrompt.style.display = 'none'; // Hide the audio prompt on successful play
                    errorMessage.classList.add('hidden'); // Hide any error message
                    console.log('تم تشغيل الصوت بنجاح.'); // Log success
                })
                .catch(error => {
                    console.error('فشل تشغيل الصوت:', error); // Log error if audio fails to play
                    errorMessage.classList.remove('hidden'); // Show error message to the user
                });
        });

        // Function to generate the story using Gemini API
        generateStoryButton.addEventListener('click', async () => {
            const promptText = storyPromptInput.value.trim();
            if (!promptText) {
                storyOutput.textContent = 'اكتبي فكرة القصة أول شيء.'; // Prompt user for input
                storyOutput.classList.remove('hidden');
                listenStoryButton.classList.add('hidden'); // Hide listen button if no story
                return;
            }

            storyLoadingIndicator.classList.remove('hidden'); // Show loading indicator
            storyOutput.classList.add('hidden'); // Hide previous story output
            listenStoryButton.classList.add('hidden'); // Hide listen button during generation
            storyOutput.textContent = ''; // Clear any previous story

            try {
                let chatHistory = [];
                // Construct the prompt for the Gemini API
                chatHistory.push({ role: "user", parts: [{ text: `اكتبي قصة نوم قصيرة وهادئة ولطيفة للأطفال عن: ${promptText}. القصة يجب أن تكون مناسبة للأطفال الصغار وتساعدهم على الاسترخاء والنوم. اجعليها حوالي 100-150 كلمة. لا تستخدمي أي مقدمات أو خاتمات للقصة، فقط نص القصة.` }] });
                const payload = { contents: chatHistory };
                // API key is left empty as it will be provided by the Canvas environment
                const apiKey = ""; 
                const apiUrl = `https://generativelanguage.googleapis.com/v1beta/models/gemini-2.0-flash:generateContent?key=${apiKey}`;

                const response = await fetch(apiUrl, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify(payload)
                });

                const result = await response.json();

                // Check if the response contains valid content
                if (result.candidates && result.candidates.length > 0 &&
                    result.candidates[0].content && result.candidates[0].content.parts &&
                    result.candidates[0].content.parts.length > 0) {
                    const story = result.candidates[0].content.parts[0].text;
                    storyOutput.textContent = story; // Display the generated story
                    storyOutput.classList.remove('hidden'); // Show the story output
                    listenStoryButton.classList.remove('hidden'); // Show listen button after successful generation
                } else {
                    storyOutput.textContent = 'عذراً، لم أتمكن من كتابة القصة. حاولي مرة ثانية.'; // Error message for user
                    storyOutput.classList.remove('hidden');
                    listenStoryButton.classList.add('hidden'); // Hide listen button on failure
                    console.error('استجابة غير متوقعة من Gemini API:', result); // Log unexpected API response
                }
            } catch (error) {
                console.error('خطأ في استدعاء Gemini API:', error); // Log API call error
                storyOutput.textContent = 'حدث خطأ أثناء كتابة القصة. يرجى التأكد من اتصالك بالإنترنت أو المحاولة لاحقاً.'; // Generic error message
                storyOutput.classList.remove('hidden');
                listenStoryButton.classList.add('hidden'); // Hide listen button on error
            } finally {
                storyLoadingIndicator.classList.add('hidden'); // Hide loading indicator
            }
        });

        // Function to convert text to speech
        listenStoryButton.addEventListener('click', () => {
            const storyText = storyOutput.textContent;
            if (storyText && 'speechSynthesis' in window) {
                const utterance = new SpeechSynthesisUtterance(storyText);
                // Attempt to set the language to Saudi Arabic.
                // Note: Regional dialect support (like ar-SA) varies significantly across browsers and OS.
                // 'ar-SA' might not be specifically recognized, and a standard Arabic or general Arabic voice might be used instead.
                utterance.lang = 'ar-SA'; 

                // Find an Arabic voice if available
                const voices = window.speechSynthesis.getVoices();
                const arabicVoice = voices.find(voice => voice.lang === 'ar-SA' || voice.lang.startsWith('ar-') && voice.name.includes('Arabic'));
                if (arabicVoice) {
                    utterance.voice = arabicVoice;
                } else {
                    console.warn('لم يتم العثور على صوت عربي سعودي محدد. سيتم استخدام الصوت الافتراضي أو أفضل صوت عربي متاح.');
                }

                window.speechSynthesis.speak(utterance);
            } else {
                console.error('متصفحك لا يدعم قراءة القصة بصوت عالٍ، أو لا توجد قصة لتشغيلها.');
                // You can display a message to the user here
            }
        });

        // Logic for showing games section
        showGamesButton.addEventListener('click', () => {
            showGamesButton.classList.add('hidden'); // Hide the button
            princessMessage.classList.remove('hidden'); // Show "ابشري يالاميرة"
            gamesSectionWrapper.classList.remove('hidden'); // Show the games section
        });


        // Tic-Tac-Toe Game Logic
        const ticTacToeBoard = document.getElementById('ticTacToeBoard');
        const ticTacToeCells = document.querySelectorAll('.tic-tac-toe-cell');
        const ticTacToeStatus = document.getElementById('ticTacToeStatus');
        const ticTacToeResetButton = document.getElementById('ticTacToeResetButton');

        let board = ['', '', '', '', '', '', '', '', ''];
        let currentPlayer = 'X'; // Human player is 'X'
        const computerPlayer = 'O'; // AI player is 'O'
        let gameActive = true;
        let ticTacToeWinMessageIndex = 0;
        const ticTacToeWinMessages = [
            'كفو يا شاطرة! فزت بجدارة! 🎉',
            'فوز رائع! 🌟',
            'ما شاء الله! إكس أو حركات! فزت! 🏆',
            'مبدعة! فوز ولا أروع! 💖',
            'لعبك ممتاز! فزت! ✨'
        ];
        const ticTacToeComputerErrorChance = 0.4; // 40% chance for computer to make a non-optimal move

        // Winning conditions for Tic-Tac-Toe
        const winningConditions = [
            [0, 1, 2],
            [3, 4, 5],
            [6, 7, 8],
            [0, 3, 6],
            [1, 4, 7],
            [2, 5, 8],
            [0, 4, 8],
            [2, 4, 6]
        ];

        // Function to handle cell clicks (human player)
        function handleCellClick(clickedCellEvent) {
            const clickedCell = clickedCellEvent.target;
            const clickedCellIndex = parseInt(clickedCell.getAttribute('data-cell-index'));

            // If the cell is already filled, game is inactive, or it's not human's turn, do nothing
            if (board[clickedCellIndex] !== '' || !gameActive || currentPlayer !== 'X') {
                return;
            }

            // Human player makes a move
            board[clickedCellIndex] = currentPlayer;
            clickedCell.textContent = currentPlayer;
            clickedCell.classList.add(currentPlayer.toLowerCase()); // Add class for styling X or O

            // Check game status after human's move
            if (handleResultValidation()) {
                return; // If game ends, stop
            }

            // Switch to computer's turn and make AI move after a short delay
            currentPlayer = computerPlayer;
            ticTacToeStatus.textContent = `دور الكمبيوتر (O)`;
            setTimeout(makeAIMove, 700); // Add a small delay for AI move
        }

        // Function to make AI move
        function makeAIMove() {
            if (!gameActive) return;

            let bestMove = -1;
            let availableMoves = [];
            for (let i = 0; i < board.length; i++) {
                if (board[i] === '') {
                    availableMoves.push(i);
                }
            }

            // If no available moves, it's a draw, but handleResultValidation should catch this
            if (availableMoves.length === 0) {
                handleResultValidation();
                return;
            }

            // Introduce a chance for the computer to make a non-optimal (random) move
            if (Math.random() < ticTacToeComputerErrorChance) {
                bestMove = availableMoves[Math.floor(Math.random() * availableMoves.length)];
            } else {
                // 1. Check if AI can win
                for (let i = 0; i < availableMoves.length; i++) {
                    const move = availableMoves[i];
                    board[move] = computerPlayer;
                    if (checkWin(board, computerPlayer)) {
                        bestMove = move;
                        board[move] = ''; // Undo for checking other moves
                        break;
                    }
                    board[move] = ''; // Undo
                }

                // 2. Check if human can win and block them
                if (bestMove === -1) {
                    for (let i = 0; i < availableMoves.length; i++) {
                        const move = availableMoves[i];
                        board[move] = 'X'; // Simulate opponent's move
                        if (checkWin(board, 'X')) {
                            bestMove = move;
                            board[move] = ''; // Undo
                            break;
                        }
                        board[move] = ''; // Undo
                    }
                }

                // 3. Take center if available
                if (bestMove === -1 && board[4] === '') {
                    bestMove = 4;
                }

                // 4. Take a corner if available
                if (bestMove === -1) {
                    const corners = [0, 2, 6, 8];
                    for (let i = 0; i < corners.length; i++) {
                        const corner = corners[i];
                        if (board[corner] === '') {
                            bestMove = corner;
                            break;
                        }
                    }
                }

                // 5. Take any available side
                if (bestMove === -1) {
                    const sides = [1, 3, 5, 7];
                    for (let i = 0; i < sides.length; i++) {
                        const side = sides[i];
                        if (board[side] === '') {
                            bestMove = side;
                            break;
                        }
                    }
                }

                // If no strategic move found, pick a random available spot (fallback)
                if (bestMove === -1 && availableMoves.length > 0) {
                    bestMove = availableMoves[Math.floor(Math.random() * availableMoves.length)];
                }
            }
            
            // Apply the AI's chosen move
            if (bestMove !== -1) {
                board[bestMove] = computerPlayer;
                ticTacToeCells[bestMove].textContent = computerPlayer;
                ticTacToeCells[bestMove].classList.add(computerPlayer.toLowerCase());

                // Check game status after AI's move
                if (handleResultValidation()) {
                    return; // If game ends, stop
                }

                // Switch back to human player's turn
                currentPlayer = 'X';
                ticTacToeStatus.textContent = `دور اللاعب X`;
            } else {
                // This case should ideally not be reached if gameActive is true and board is not full
                console.error("AI couldn't find a move!");
            }
        }

        // Helper function to check for a win for a given player
        function checkWin(currentBoard, player) {
            for (let i = 0; i < winningConditions.length; i++) {
                const winCondition = winningConditions[i];
                let a = currentBoard[winCondition[0]];
                let b = currentBoard[winCondition[1]];
                let c = currentBoard[winCondition[2]];

                if (a === player && b === player && c === player) {
                    return true;
                }
            }
            return false;
        }

        // Function to validate game result
        function handleResultValidation() {
            // Check for a win for the current player
            if (checkWin(board, currentPlayer)) {
                if (currentPlayer === 'X') { // Human won
                    ticTacToeStatus.textContent = ticTacToeWinMessages[ticTacToeWinMessageIndex];
                    ticTacToeWinMessageIndex = (ticTacToeWinMessageIndex + 1) % ticTacToeWinMessages.length; // Cycle message
                } else { // Computer won
                    ticTacToeStatus.textContent = `الكمبيوتر فاز هذه المرة! 🤖`;
                }
                gameActive = false;
                return true;
            }

            // Check for a draw
            let roundDraw = !board.includes('');
            if (roundDraw) {
                ticTacToeStatus.textContent = 'تعادل! 🤝';
                gameActive = false;
                return true;
            }
            return false; // Game is still active
        }

        // Function to reset the game
        function handleRestartGame() {
            gameActive = true;
            currentPlayer = 'X'; // Human player starts
            board = ['', '', '', '', '', '', '', '', ''];
            ticTacToeStatus.textContent = `دور اللاعب X`;
            ticTacToeCells.forEach(cell => {
                cell.textContent = '';
                cell.classList.remove('x', 'o'); // Remove X/O styling classes
            });
        }

        // Add event listeners for Tic-Tac-Toe
        ticTacToeCells.forEach(cell => cell.addEventListener('click', handleCellClick));
        ticTacToeResetButton.addEventListener('click', handleRestartGame);

        // Rock-Paper-Scissors Game Logic
        const rpsChoices = document.querySelectorAll('.rps-choice-button');
        const rpsResult = document.getElementById('rpsResult');
        const rpsWinMessages = [
            'كفو! فزت! أنتِ اخترتِ ${playerChoiceArabic} والكمبيوتر اختار ${computerChoiceArabic}.',
            'أحسنتِ! فزتِ هذه المرة! أنتِ اخترتِ ${playerChoiceArabic} والكمبيوتر اختار ${computerChoiceArabic}.',
            'فوز رائع! أنتِ اخترتِ ${playerChoiceArabic} والكمبيوتر اختار ${computerChoiceArabic}.'
        ];
        const rpsLoseMessages = [
            'خسرتِ هذه المرة! أنتِ اخترتِ ${playerChoiceArabic} والكمبيوتر اختار ${computerChoiceArabic}.',
            'حظ أوفر المرة القادمة! أنتِ اخترتِ ${playerChoiceArabic} والكمبيوتر اختار ${computerChoiceArabic}.',
            'الكمبيوتر فاز هذه المرة. أنتِ اخترتِ ${playerChoiceArabic} والكمبيوتر اختار ${computerChoiceArabic}.'
        ];
        let rpsWinMessageIndex = 0;
        let rpsLoseMessageIndex = 0;

        // Function to play Rock-Paper-Scissors
        function playRPS(playerChoice) {
            const choices = ['rock', 'paper', 'scissors'];
            const computerChoice = choices[Math.floor(Math.random() * choices.length)];

            let result = '';
            const playerChoiceArabic = getArabicChoice(playerChoice);
            const computerChoiceArabic = getArabicChoice(computerChoice);

            // Determine the winner
            if (playerChoice === computerChoice) {
                result = `تعادل! كلاكما اختار ${playerChoiceArabic}.`;
            } else if (
                (playerChoice === 'rock' && computerChoice === 'scissors') ||
                (playerChoice === 'paper' && computerChoice === 'rock') ||
                (playerChoice === 'scissors' && computerChoice === 'paper')
            ) {
                result = rpsWinMessages[rpsWinMessageIndex]
                    .replace('${playerChoiceArabic}', playerChoiceArabic)
                    .replace('${computerChoiceArabic}', computerChoiceArabic);
                rpsWinMessageIndex = (rpsWinMessageIndex + 1) % rpsWinMessages.length;
            } else {
                result = rpsLoseMessages[rpsLoseMessageIndex]
                    .replace('${playerChoiceArabic}', playerChoiceArabic)
                    .replace('${computerChoiceArabic}', computerChoiceArabic);
                rpsLoseMessageIndex = (rpsLoseMessageIndex + 1) % rpsLoseMessages.length;
            }
            rpsResult.textContent = result; // Display the result
        }

        // Helper function to get Arabic choice name
        function getArabicChoice(choice) {
            switch (choice) {
                case 'rock': return 'حجر ✊';
                case 'paper': return 'ورقة ✋';
                case 'scissors': return 'مقص ✌️';
                default: return '';
            }
        }

        // Add event listeners for Rock-Paper-Scissors buttons
        rpsChoices.forEach(button => {
            button.addEventListener('click', (e) => {
                const playerChoice = e.target.dataset.choice;
                playRPS(playerChoice);
            });
        });

        // Guess the Number Game Logic
        const guessInput = document.getElementById('guessInput');
        const guessButton = document.getElementById('guessButton');
        const guessMessage = document.getElementById('guessMessage');
        const guessCountDisplay = document.getElementById('guessCount');
        const guessResetButton = document.getElementById('guessResetButton');

        let secretNumber;
        let attempts;
        let gameEnded;
        let guessWinMessageIndex = 0;
        const guessWinMessages = [
            'كفو! خمنت الرقم الصحيح في ${attempts} محاولات! 🎉',
            'ممتاز! جبت الرقم صح في ${attempts} محاولات! 🌟',
            'رائع! الرقم السري لم يخف عليك! فوز رائع في ${attempts} محاولات! 🏆'
        ];

        // Function to initialize the Guess the Number game
        function initializeGuessNumberGame() {
            secretNumber = Math.floor(Math.random() * 100) + 1; // Random number between 1 and 100
            attempts = 0;
            gameEnded = false;
            guessMessage.textContent = '';
            guessCountDisplay.textContent = 'المحاولات: 0';
            guessInput.value = '';
            guessInput.disabled = false;
            guessButton.disabled = false;
            console.log('Secret Number (for debugging):', secretNumber); // For debugging
        }

        // Function to handle a guess
        function handleGuess() {
            if (gameEnded) return;

            const userGuess = parseInt(guessInput.value);

            if (isNaN(userGuess) || userGuess < 1 || userGuess > 100) {
                guessMessage.textContent = 'أدخلي رقم صحيح بين 1 و 100.';
                return;
            }

            attempts++;
            guessCountDisplay.textContent = `المحاولات: ${attempts}`;

            if (userGuess === secretNumber) {
                guessMessage.textContent = guessWinMessages[guessWinMessageIndex].replace('${attempts}', attempts).replace('${secretNumber}', secretNumber);
                guessWinMessageIndex = (guessWinMessageIndex + 1) % guessWinMessages.length;
                gameEnded = true;
                guessInput.disabled = true;
                guessButton.disabled = true;
            } else if (userGuess < secretNumber) {
                guessMessage.textContent = 'الرقم السري أكبر. حاولي مرة أخرى.';
            } else {
                guessMessage.textContent = 'الرقم السري أصغر. حاولي مرة أخرى.';
            }
            guessInput.value = ''; // Clear input after guess
        }

        // Event listeners for Guess the Number game
        guessButton.addEventListener('click', handleGuess);
        guessInput.addEventListener('keypress', (e) => {
            if (e.key === 'Enter') {
                handleGuess();
            }
        });
        guessResetButton.addEventListener('click', initializeGuessNumberGame);

        // Memory Match Game Logic
        const memoryGrid = document.getElementById('memoryGrid');
        const memoryStatus = document.querySelector('.memory-status');
        const memoryResetButton = document.getElementById('memoryResetButton');

        const emojis = ['🌟', '🌙', '🧸', '💖', '🌈', '✨', '🌸', '🦋']; // 8 unique emojis
        let cards = [];
        let flippedCards = [];
        let matchedPairs = 0;
        let attemptsMade = 0;
        let lockBoard = false; // To prevent flipping more than two cards at once
        let memoryWinMessageIndex = 0;
        const memoryWinMessages = [
            'كفو! أكملت اللعبة في ${attemptsMade} محاولات! 🎉',
            'ذاكرتك قوية! أبدعتِ في ${attemptsMade} محاولات! 🧠',
            'ممتاز! كل الأزواج صحيحة في ${attemptsMade} محاولات! 💖'
        ];


        // Function to shuffle an array (Fisher-Yates algorithm)
        function shuffleArray(array) {
            for (let i = array.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [array[i], array[j]] = [array[j], array[i]];
            }
            return array;
        }

        // Function to initialize the Memory Match game
        function initializeMemoryGame() {
            memoryGrid.innerHTML = ''; // Clear previous cards
            flippedCards = [];
            matchedPairs = 0;
            attemptsMade = 0;
            lockBoard = false;
            memoryStatus.textContent = 'المحاولات: 0 | الأزواج الصحيحة: 0';

            // Duplicate emojis to create pairs
            cards = [...emojis, ...emojis];
            shuffleArray(cards); // Shuffle the cards

            // Create card elements
            cards.forEach((emoji, index) => {
                const cardElement = document.createElement('div');
                cardElement.classList.add('memory-card');
                cardElement.dataset.emoji = emoji;
                cardElement.dataset.index = index;

                cardElement.innerHTML = `
                    <div class="card-face card-front">${emoji}</div>
                    <div class="card-face card-back"></div>
                `;
                cardElement.addEventListener('click', flipCard);
                memoryGrid.appendChild(cardElement);
            });
        }

        // Function to flip a card
        function flipCard() {
            if (lockBoard) return; // Prevent flipping if board is locked
            if (this === flippedCards[0]) return; // Prevent clicking the same card twice

            this.classList.add('flipped');
            flippedCards.push(this);

            if (flippedCards.length === 2) {
                attemptsMade++;
                memoryStatus.textContent = `المحاولات: ${attemptsMade} | الأزواج الصحيحة: ${matchedPairs}`;
                lockBoard = true; // Lock the board
                checkForMatch();
            }
        }

        // Function to check if two flipped cards match
        function checkForMatch() {
            const [card1, card2] = flippedCards;
            const isMatch = card1.dataset.emoji === card2.dataset.emoji;

            if (isMatch) {
                disableCards();
            } else {
                unflipCards();
            }
        }

        // Function to disable matched cards
        function disableCards() {
            flippedCards[0].classList.add('matched');
            flippedCards[1].classList.add('matched');
            matchedPairs++;
            memoryStatus.textContent = `المحاولات: ${attemptsMade} | الأزواج الصحيحة: ${matchedPairs}`;

            resetFlippedCards();
            checkWinMemoryGame();
        }

        // Function to unflip non-matching cards
        function unflipCards() {
            setTimeout(() => {
                flippedCards[0].classList.remove('flipped');
                flippedCards[1].classList.remove('flipped');
                resetFlippedCards();
            }, 1000); // Wait 1 second before unflipping
        }

        // Function to reset flipped cards array and unlock board
        function resetFlippedCards() {
            [flippedCards[0], flippedCards[1]] = [null, null];
            flippedCards = [];
            lockBoard = false;
        }

        // Function to check if all pairs are matched
        function checkWinMemoryGame() {
            if (matchedPairs === emojis.length) {
                memoryStatus.textContent = memoryWinMessages[memoryWinMessageIndex].replace('${attemptsMade}', attemptsMade);
                memoryWinMessageIndex = (memoryWinMessageIndex + 1) % memoryWinMessages.length;
                gameActive = false; // Consider the game ended
            }
        }

        // Event listener for Memory Match reset button
        memoryResetButton.addEventListener('click', initializeMemoryGame);


        // Whack-a-Mole Game Logic
        const whackAMoleGrid = document.getElementById('whackAMoleGrid');
        const whackAMoleScoreDisplay = document.querySelector('.whack-a-mole-score');
        const whackAMoleTimeDisplay = document.querySelector('.whack-a-mole-time');
        const whackAMoleStartButton = document.getElementById('whackAMoleStartButton');
        const whackAMoleResetButton = document.getElementById('whackAMoleResetButton');

        const moleEmojis = ['🐭', '🐰', '🦊', '🐻', '🐼', '🐨', '🐯', '🦁', '🐸']; // Emojis for moles
        let score = 0;
        let timeRemaining = 30; // seconds
        let timerId;
        let moleInterval;
        let lastMoleHole;
        let gameRunning = false;
        let whackAMoleEndMessageIndex = 0;
        const whackAMoleEndMessages = [
            'كفو! انتهت اللعبة! جبتِ ${score} نقطة! 🏆',
            'انتهى الوقت! نقاطك: ${score}! ✨',
            'لعبتِ جيداً! جبتِ ${score} نقطة! 🎉'
        ];

        // Create mole holes dynamically
        function createMoleHoles() {
            whackAMoleGrid.innerHTML = ''; // Clear existing holes
            for (let i = 0; i < 9; i++) { // 3x3 grid
                const hole = document.createElement('div');
                hole.classList.add('mole-hole');
                const mole = document.createElement('div');
                mole.classList.add('mole-emoji');
                mole.textContent = moleEmojis[Math.floor(Math.random() * moleEmojis.length)]; // Assign random emoji
                mole.addEventListener('click', whackMole);
                hole.appendChild(mole);
                whackAMoleGrid.appendChild(hole);
            }
        }

        // Function to get a random hole
        function getRandomHole() {
            const holes = document.querySelectorAll('.mole-hole');
            const randomIndex = Math.floor(Math.random() * holes.length);
            const selectedHole = holes[randomIndex];

            if (selectedHole === lastMoleHole) {
                return getRandomHole(); // Avoid showing mole in the same hole twice in a row
            }
            lastMoleHole = selectedHole;
            return selectedHole;
        }

        // Function to show a mole
        function showMole() {
            const moles = document.querySelectorAll('.mole-emoji');
            moles.forEach(mole => mole.classList.remove('up')); // Hide all moles

            const randomHole = getRandomHole();
            const moleToShow = randomHole.querySelector('.mole-emoji');
            moleToShow.textContent = moleEmojis[Math.floor(Math.random() * moleEmojis.length)]; // Change emoji
            moleToShow.classList.add('up'); // Show the mole

            // Hide mole after a random time
            setTimeout(() => {
                moleToShow.classList.remove('up');
            }, Math.random() * 800 + 400); // Mole stays up for 0.4 to 1.2 seconds
        }

        // Function to whack a mole
        function whackMole(event) {
            if (!gameRunning) return;
            if (event.target.classList.contains('up')) {
                score++;
                whackAMoleScoreDisplay.textContent = `النقاط: ${score}`;
                event.target.classList.remove('up'); // Hide the whacked mole immediately
            }
        }

        // Function to start the game timer
        function startGameTimer() {
            timeRemaining = 30;
            score = 0;
            whackAMoleScoreDisplay.textContent = `النقاط: ${score}`;
            whackAMoleTimeDisplay.textContent = `الوقت: ${timeRemaining} ثانية`;
            gameRunning = true;

            timerId = setInterval(() => {
                timeRemaining--;
                whackAMoleTimeDisplay.textContent = `الوقت: ${timeRemaining} ثانية`;

                if (timeRemaining <= 0) {
                    clearInterval(timerId);
                    clearInterval(moleInterval);
                    gameRunning = false;
                    whackAMoleTimeDisplay.textContent = `انتهى الوقت!`;
                    whackAMoleStartButton.classList.remove('hidden');
                    whackAMoleResetButton.classList.remove('hidden'); // Show reset button
                    alertUser(whackAMoleEndMessages[whackAMoleEndMessageIndex].replace('${score}', score));
                    whackAMoleEndMessageIndex = (whackAMoleEndMessageIndex + 1) % whackAMoleEndMessages.length;
                }
            }, 1000); // Update every second

            moleInterval = setInterval(showMole, 1000); // Moles appear every 1 second
            whackAMoleStartButton.classList.add('hidden');
            whackAMoleResetButton.classList.add('hidden'); // Hide reset button during game
        }

        // Function to reset Whack-a-Mole game
        function resetWhackAMoleGame() {
            clearInterval(timerId);
            clearInterval(moleInterval);
            gameRunning = false;
            score = 0;
            timeRemaining = 30;
            whackAMoleScoreDisplay.textContent = `النقاط: 0`;
            whackAMoleTimeDisplay.textContent = `الوقت: 30 ثانية`;
            const moles = document.querySelectorAll('.mole-emoji');
            moles.forEach(mole => mole.classList.remove('up'));
            whackAMoleStartButton.classList.remove('hidden');
            whackAMoleResetButton.classList.add('hidden');
        }

        // Custom alert function (instead of window.alert)
        function alertUser(message) {
            const alertBox = document.createElement('div');
            alertBox.style.cssText = `
                position: fixed;
                top: 50%;
                left: 50%;
                transform: translate(-50%, -50%);
                background-color: rgba(0, 0, 0, 0.8);
                color: white;
                padding: 20px;
                border-radius: 10px;
                box-shadow: 0 0 15px rgba(0, 0, 0, 0.5);
                z-index: 1000;
                font-family: 'Cairo', sans-serif;
                font-size: 1.2rem;
                text-align: center;
                display: flex;
                flex-direction: column;
                align-items: center;
                gap: 15px;
            `;
            alertBox.innerHTML = `
                <p>${message}</p>
                <button style="
                    background-color: #f8bbd0;
                    color: #332e40;
                    padding: 10px 20px;
                    border-radius: 9999px;
                    border: none;
                    cursor: pointer;
                    font-weight: 700;
                    transition: background-color 0.3s ease;
                ">موافق</button>
            `;
            document.body.appendChild(alertBox);
            alertBox.querySelector('button').addEventListener('click', () => {
                document.body.removeChild(alertBox);
            });
        }


        // Event listeners for Whack-a-Mole
        whackAMoleStartButton.addEventListener('click', startGameTimer);
        whackAMoleResetButton.addEventListener('click', resetWhackAMoleGame);

        // Bubble Pop Game Logic
        const bubbleArea = document.getElementById('bubbleArea');
        const bubblePopScoreDisplay = document.querySelector('.bubble-pop-score');
        const bubblePopTimeDisplay = document.querySelector('.bubble-pop-time');
        const bubblePopStartButton = document.getElementById('bubblePopStartButton');
        const bubblePopResetButton = document.getElementById('bubblePopResetButton');

        let bubbleScore = 0;
        let bubbleTimeRemaining = 20; // seconds
        let bubbleTimerId;
        let bubbleIntervalId;
        let bubbleGameRunning = false;
        const bubbleEmojis = ['🎈', '🌟', '💧', '✨', '💖', '🫧']; // Emojis for bubbles
        let bubblePopEndMessageIndex = 0;
        const bubblePopEndMessages = [
            'كفو! فرقعتِ ${bubbleScore} فقاعة! 🫧',
            'انتهى الوقت! جبتِ ${bubbleScore} فقاعة! 🎉',
            'ممتاز! فرقعتِ ${bubbleScore} فقاعة! 🌟'
        ];

        function createBubble() {
            if (!bubbleGameRunning) return;

            const bubble = document.createElement('div');
            bubble.classList.add('bubble');
            const size = Math.random() * 40 + 30; // Bubble size between 30px and 70px
            bubble.style.width = `${size}px`;
            bubble.style.height = `${size}px`;
            bubble.style.left = `${Math.random() * (bubbleArea.offsetWidth - size)}px`; // Random horizontal position
            bubble.style.animationDuration = `${Math.random() * 3 + 3}s`; // Animation duration 3-6 seconds
            bubble.style.animationDelay = `${Math.random() * 0.5}s`; // Slight delay for staggered appearance
            bubble.textContent = bubbleEmojis[Math.floor(Math.random() * bubbleEmojis.length)]; // Random emoji

            bubble.addEventListener('click', () => {
                if (bubbleGameRunning) {
                    bubbleScore++;
                    bubblePopScoreDisplay.textContent = `النقاط: ${bubbleScore}`;
                    bubble.remove(); // Remove popped bubble
                }
            });

            bubbleArea.appendChild(bubble);

            // Remove bubble after animation ends to prevent accumulation
            bubble.addEventListener('animationend', () => {
                bubble.remove();
            });
        }

        function startBubblePopGame() {
            bubbleScore = 0;
            bubbleTimeRemaining = 20;
            bubblePopScoreDisplay.textContent = `النقاط: ${bubbleScore}`;
            bubblePopTimeDisplay.textContent = `الوقت: ${bubbleTimeRemaining} ثانية`;
            bubbleGameRunning = true;
            bubblePopStartButton.classList.add('hidden');
            bubblePopResetButton.classList.add('hidden');
            bubbleArea.innerHTML = ''; // Clear existing bubbles

            bubbleTimerId = setInterval(() => {
                bubbleTimeRemaining--;
                bubblePopTimeDisplay.textContent = `الوقت: ${bubbleTimeRemaining} ثانية`;
                if (bubbleTimeRemaining <= 0) {
                    clearInterval(bubbleTimerId);
                    clearInterval(bubbleIntervalId);
                    bubbleGameRunning = false;
                    bubblePopTimeDisplay.textContent = `انتهى الوقت!`;
                    bubblePopStartButton.classList.remove('hidden');
                    bubblePopResetButton.classList.remove('hidden');
                    alertUser(bubblePopEndMessages[bubblePopEndMessageIndex].replace('${bubbleScore}', bubbleScore));
                    bubblePopEndMessageIndex = (bubblePopEndMessageIndex + 1) % bubblePopEndMessages.length;
                    // Remove all bubbles when game ends
                    document.querySelectorAll('.bubble').forEach(b => b.remove());
                }
            }, 1000);

            bubbleIntervalId = setInterval(createBubble, 500); // Create a new bubble every 0.5 seconds
        }

        function resetBubblePopGame() {
            clearInterval(bubbleTimerId);
            clearInterval(bubbleIntervalId);
            bubbleGameRunning = false;
            bubbleScore = 0;
            bubbleTimeRemaining = 20;
            bubblePopScoreDisplay.textContent = `النقاط: 0`;
            bubblePopTimeDisplay.textContent = `الوقت: 20 ثانية`;
            bubbleArea.innerHTML = ''; // Clear all bubbles
            bubblePopStartButton.classList.remove('hidden');
            bubblePopResetButton.classList.add('hidden');
        }

        bubblePopStartButton.addEventListener('click', startBubblePopGame);
        bubblePopResetButton.addEventListener('click', resetBubblePopGame);

        // Color Match Game Logic
        const targetColorDisplay = document.getElementById('targetColorDisplay');
        const colorChoicesGrid = document.getElementById('colorChoicesGrid');
        const colorMatchMessage = document.getElementById('colorMatchMessage');
        const colorMatchScoreDisplay = document.querySelector('.color-match-score');
        const colorMatchResetButton = document.getElementById('colorMatchResetButton');

        const colors = [
            '#FF6347', '#FFD700', '#6A5ACD', '#32CD32', '#FF69B4', // Tomato, Gold, SlateBlue, LimeGreen, HotPink
            '#1E90FF', '#FF4500', '#BA55D3', '#7FFF00', '#DC143C'  // DodgerBlue, OrangeRed, MediumPurple, Chartreuse, Crimson
        ];
        let currentColorIndex;
        let colorMatchScore = 0;
        let colorGameActive = false;
        let colorMatchWinMessageIndex = 0;
        const colorMatchWinMessages = [
            'كفو! صح عليك! 🎨',
            'مطابقة رائعة! 🌈',
            'ممتاز! جبتيها صح! 💖'
        ];

        function getRandomColor() {
            return colors[Math.floor(Math.random() * colors.length)];
        }

        function initializeColorMatchGame() {
            colorMatchScore = 0;
            colorMatchScoreDisplay.textContent = `النقاط: ${colorMatchScore}`;
            colorMatchMessage.textContent = '';
            colorChoicesGrid.innerHTML = ''; // Clear previous choices
            colorGameActive = true;
            generateNewRound();
        }

        function generateNewRound() {
            if (!colorGameActive) return;

            colorChoicesGrid.innerHTML = '';
            colorMatchMessage.textContent = '';

            const targetColor = getRandomColor();
            targetColorDisplay.style.backgroundColor = targetColor;

            const choiceColors = [targetColor];
            while (choiceColors.length < 4) { // Generate 3 more distinct random colors
                const newColor = getRandomColor();
                if (!choiceColors.includes(newColor)) {
                    choiceColors.push(newColor);
                }
            }
            shuffleArray(choiceColors); // Shuffle choices

            choiceColors.forEach(color => {
                const button = document.createElement('button');
                button.classList.add('color-choice-button');
                button.style.backgroundColor = color;
                button.dataset.color = color;
                button.addEventListener('click', handleColorChoice);
                colorChoicesGrid.appendChild(button);
            });
        }

        function handleColorChoice(event) {
            if (!colorGameActive) return;

            const selectedColor = event.target.dataset.color;
            const targetColor = targetColorDisplay.style.backgroundColor;

            // Convert targetColor to hex if it's RGB (browser might return RGB)
            const rgbToHex = (rgb) => {
                const parts = rgb.match(/\d+/g);
                if (parts && parts.length >= 3) {
                    const toHex = (c) => ('0' + parseInt(c).toString(16)).slice(-2);
                    return '#' + toHex(parts[0]) + toHex(parts[1]) + toHex(parts[2]).toUpperCase();
                }
                return rgb; // Return as is if not in expected RGB format
            };

            const targetColorHex = targetColor.startsWith('rgb') ? rgbToHex(targetColor) : targetColor;

            if (selectedColor.toUpperCase() === targetColorHex.toUpperCase()) {
                colorMatchScore++;
                colorMatchScoreDisplay.textContent = `النقاط: ${colorMatchScore}`;
                colorMatchMessage.textContent = colorMatchWinMessages[colorMatchWinMessageIndex];
                colorMatchWinMessageIndex = (colorMatchWinMessageIndex + 1) % colorMatchWinMessages.length;
                setTimeout(generateNewRound, 1000); // Next round after 1 second
            } else {
                colorMatchMessage.textContent = 'خطأ. حاولي مرة ثانية.';
            }
        }

        colorMatchResetButton.addEventListener('click', initializeColorMatchGame);

        // New Game 1: Catch the Stars Logic
        const starsArea = document.getElementById('starsArea');
        const catchStarsScoreDisplay = document.querySelector('.catch-stars-score');
        const catchStarsTimeDisplay = document.querySelector('.catch-stars-time');
        const catchStarsStartButton = document.getElementById('catchStarsStartButton');
        const catchStarsResetButton = document.getElementById('catchStarsResetButton');

        let catchStarsScore = 0;
        let catchStarsTimeRemaining = 20;
        let catchStarsTimerId;
        let createStarsIntervalId;
        let catchStarsGameRunning = false;
        const starEmojis = ['⭐', '🌟', '✨', '💫'];
        let catchStarsEndMessageIndex = 0;
        const catchStarsEndMessages = [
            'كفو! التقطتِ ${score} نجمة! ✨',
            'انتهى الوقت! نقاطك: ${score} نجمة! 🌟',
            'أحسنتِ! جمعتِ ${score} نجمة! 🏆'
        ];

        function createFallingStar() {
            if (!catchStarsGameRunning) return;

            const star = document.createElement('div');
            star.classList.add('falling-star');
            star.textContent = starEmojis[Math.floor(Math.random() * starEmojis.length)];
            star.style.left = `${Math.random() * (starsArea.offsetWidth - 50)}px`; // Random horizontal position
            star.style.animationDuration = `${Math.random() * 2 + 3}s`; // Fall duration 3-5 seconds

            star.addEventListener('click', () => {
                if (catchStarsGameRunning) {
                    catchStarsScore++;
                    catchStarsScoreDisplay.textContent = `النقاط: ${catchStarsScore}`;
                    star.remove();
                }
            });

            starsArea.appendChild(star);

            star.addEventListener('animationend', () => {
                star.remove();
            });
        }

        function startCatchStarsGame() {
            catchStarsScore = 0;
            catchStarsTimeRemaining = 20;
            catchStarsScoreDisplay.textContent = `النقاط: ${catchStarsScore}`;
            catchStarsTimeDisplay.textContent = `الوقت: ${catchStarsTimeRemaining} ثانية`;
            catchStarsGameRunning = true;
            catchStarsStartButton.classList.add('hidden');
            catchStarsResetButton.classList.add('hidden');
            starsArea.innerHTML = '';

            catchStarsTimerId = setInterval(() => {
                catchStarsTimeRemaining--;
                catchStarsTimeDisplay.textContent = `الوقت: ${catchStarsTimeRemaining} ثانية`;
                if (catchStarsTimeRemaining <= 0) {
                    clearInterval(catchStarsTimerId);
                    clearInterval(createStarsIntervalId);
                    catchStarsGameRunning = false;
                    catchStarsTimeDisplay.textContent = `انتهى الوقت!`;
                    catchStarsStartButton.classList.remove('hidden');
                    catchStarsResetButton.classList.remove('hidden');
                    alertUser(catchStarsEndMessages[catchStarsEndMessageIndex].replace('${score}', catchStarsScore));
                    catchStarsEndMessageIndex = (catchStarsEndMessageIndex + 1) % catchStarsEndMessages.length;
                    document.querySelectorAll('.falling-star').forEach(s => s.remove());
                }
            }, 1000);

            createStarsIntervalId = setInterval(createFallingStar, 700); // Create a new star every 0.7 seconds
        }

        function resetCatchStarsGame() {
            clearInterval(catchStarsTimerId);
            clearInterval(createStarsIntervalId);
            catchStarsGameRunning = false;
            catchStarsScore = 0;
            catchStarsTimeRemaining = 20;
            catchStarsScoreDisplay.textContent = `النقاط: 0`;
            catchStarsTimeDisplay.textContent = `الوقت: 20 ثانية`;
            starsArea.innerHTML = '';
            catchStarsStartButton.classList.remove('hidden');
            catchStarsResetButton.classList.add('hidden');
        }

        catchStarsStartButton.addEventListener('click', startCatchStarsGame);
        catchStarsResetButton.addEventListener('click', resetCatchStarsGame);

        // New Game 2: Simple Drawing Pad Logic
        const drawingCanvas = document.getElementById('drawingCanvas');
        const ctx = drawingCanvas.getContext('2d');
        const colorPicker = document.getElementById('colorPicker');
        const brushSize = document.getElementById('brushSize');
        const clearCanvasButton = document.getElementById('clearCanvasButton');

        let isDrawing = false;
        let lastX = 0;
        let lastY = 0;

        // Set canvas dimensions dynamically and draw initial white background
        function resizeCanvas() {
            drawingCanvas.width = drawingCanvas.offsetWidth;
            drawingCanvas.height = drawingCanvas.offsetHeight;
            ctx.fillStyle = 'white'; // Set background color
            ctx.fillRect(0, 0, drawingCanvas.width, drawingCanvas.height); // Fill canvas
        }

        // Initial resize and on window resize
        window.addEventListener('resize', resizeCanvas);
        // Call resizeCanvas after the DOM is ready and canvas is rendered
        function initializeDrawingPad() {
            requestAnimationFrame(() => {
                resizeCanvas();
            });
        }

        // Function to start a new drawing path
        function startDrawing(x, y) {
            isDrawing = true;
            [lastX, lastY] = [x, y];
            ctx.beginPath(); // Start a new path for this stroke
            ctx.moveTo(lastX, lastY); // Move to the starting point of the stroke
        }

        // Function to draw during a stroke
        function draw(x, y) {
            if (!isDrawing) return;
            ctx.strokeStyle = colorPicker.value;
            ctx.lineWidth = brushSize.value;
            ctx.lineCap = 'round';
            ctx.lineTo(x, y); // Draw line to current position
            ctx.stroke(); // Stroke the current path
            [lastX, lastY] = [x, y]; // Update last position for the next segment
        }

        // Mouse events
        drawingCanvas.addEventListener('mousedown', (e) => {
            startDrawing(e.offsetX, e.offsetY);
        });
        drawingCanvas.addEventListener('mousemove', (e) => {
            draw(e.offsetX, e.offsetY);
        });
        drawingCanvas.addEventListener('mouseup', () => isDrawing = false);
        drawingCanvas.addEventListener('mouseout', () => isDrawing = false);

        // Touch events for drawing
        drawingCanvas.addEventListener('touchstart', (e) => {
            e.preventDefault(); // Prevent scrolling
            const touch = e.touches[0];
            const rect = drawingCanvas.getBoundingClientRect();
            const x = touch.clientX - rect.left;
            const y = touch.clientY - rect.top;
            startDrawing(x, y);
        }, { passive: false });

        drawingCanvas.addEventListener('touchmove', (e) => {
            e.preventDefault(); // Prevent scrolling
            const touch = e.touches[0];
            const rect = drawingCanvas.getBoundingClientRect();
            const x = touch.clientX - rect.left;
            const y = touch.clientY - rect.top;
            draw(x, y);
        }, { passive: false });

        drawingCanvas.addEventListener('touchend', () => isDrawing = false);
        drawingCanvas.addEventListener('touchcancel', () => isDrawing = false);


        clearCanvasButton.addEventListener('click', () => {
            ctx.clearRect(0, 0, drawingCanvas.width, drawingCanvas.height);
            ctx.fillStyle = 'white'; // Set background color again after clearing
            ctx.fillRect(0, 0, drawingCanvas.width, drawingCanvas.height); // Fill canvas
        });

        // New Game 3: Whack-a-Number Logic
        const whackANumberGrid = document.getElementById('whackANumberGrid');
        const whackANumberTargetDisplay = document.getElementById('whackANumberTarget');
        const whackANumberScoreDisplay = document.querySelector('.whack-a-number-score');
        const whackANumberTimeDisplay = document.querySelector('.whack-a-number-time');
        const whackANumberStartButton = document.getElementById('whackANumberStartButton');
        const whackANumberResetButton = document.getElementById('whackANumberResetButton');

        let whackANumberScore = 0;
        let whackANumberTimeRemaining = 30;
        let whackANumberTimerId;
        let whackANumberInterval;
        let currentTargetNumber;
        let whackANumberGameRunning = false;
        let lastNumberHole;
        const whackANumberEndMessageIndex = 0;
        const whackANumberEndMessages = [
            'كفو! انتهت اللعبة! جبتِ ${score} نقطة! 🏆',
            'انتهى الوقت! نقاطك: ${score}! ✨',
            'لعبتِ جيداً! جبتِ ${score} نقطة! 🎉'
        ];


        function createNumberHoles() {
            whackANumberGrid.innerHTML = '';
            for (let i = 0; i < 9; i++) {
                const hole = document.createElement('div');
                hole.classList.add('number-hole');
                const numberDisplay = document.createElement('div');
                numberDisplay.classList.add('number-display');
                numberDisplay.addEventListener('click', handleNumberClick);
                hole.appendChild(numberDisplay);
                whackANumberGrid.appendChild(hole);
            }
        }

        function getRandomNumberHole() {
            const holes = document.querySelectorAll('.number-hole');
            const randomIndex = Math.floor(Math.random() * holes.length);
            const selectedHole = holes[randomIndex];

            if (selectedHole === lastNumberHole) {
                return getRandomNumberHole();
            }
            lastNumberHole = selectedHole;
            return selectedHole;
        }

        function showNumber() {
            if (!whackANumberGameRunning) return;

            const numberDisplays = document.querySelectorAll('.number-display');
            numberDisplays.forEach(display => display.classList.remove('up'));

            const randomHole = getRandomNumberHole();
            const numberToShow = randomHole.querySelector('.number-display');
            const randomNumber = Math.floor(Math.random() * 9) + 1; // Numbers 1-9
            numberToShow.textContent = randomNumber;
            numberToShow.classList.add('up');

            setTimeout(() => {
                numberToShow.classList.remove('up');
            }, Math.random() * 800 + 400);
        }

        function handleNumberClick(event) {
            if (!whackANumberGameRunning) return;

            const clickedNumber = parseInt(event.target.textContent);
            if (clickedNumber === currentTargetNumber) {
                whackANumberScore++;
                whackANumberScoreDisplay.textContent = `النقاط: ${whackANumberScore}`;
                event.target.classList.remove('up');
                setNewTargetNumber(); // Set a new target number after a correct hit
            } else {
                // Optional: penalize for wrong click
                // whackANumberScore = Math.max(0, whackANumberScore - 1);
                // whackANumberScoreDisplay.textContent = `النقاط: ${whackANumberScore}`;
            }
        }

        function setNewTargetNumber() {
            currentTargetNumber = Math.floor(Math.random() * 9) + 1; // New target 1-9
            whackANumberTargetDisplay.textContent = currentTargetNumber;
        }

        function startWhackANumberGame() {
            whackANumberScore = 0;
            whackANumberTimeRemaining = 30;
            whackANumberScoreDisplay.textContent = `النقاط: ${whackANumberScore}`;
            whackANumberTimeDisplay.textContent = `الوقت: ${whackANumberTimeRemaining} ثانية`;
            whackANumberGameRunning = true;
            whackANumberStartButton.classList.add('hidden');
            whackANumberResetButton.classList.add('hidden');
            createNumberHoles(); // Ensure holes are created and clear
            setNewTargetNumber();

            whackANumberTimerId = setInterval(() => {
                whackANumberTimeRemaining--;
                whackANumberTimeDisplay.textContent = `الوقت: ${whackANumberTimeRemaining} ثانية`;
                if (whackANumberTimeRemaining <= 0) {
                    clearInterval(whackANumberTimerId);
                    clearInterval(whackANumberInterval);
                    whackANumberGameRunning = false;
                    whackANumberTimeDisplay.textContent = `انتهى الوقت!`;
                    whackANumberStartButton.classList.remove('hidden');
                    whackANumberResetButton.classList.remove('hidden');
                    alertUser(whackANumberEndMessages[whackANumberEndMessageIndex].replace('${score}', whackANumberScore));
                    whackANumberEndMessageIndex = (whackANumberEndMessageIndex + 1) % whackANumberEndMessages.length;
                    document.querySelectorAll('.number-display').forEach(d => d.classList.remove('up'));
                }
            }, 1000);

            whackANumberInterval = setInterval(showNumber, 1000);
        }

        function resetWhackANumberGame() {
            clearInterval(whackANumberTimerId);
            clearInterval(whackANumberInterval);
            whackANumberGameRunning = false;
            whackANumberScore = 0;
            whackANumberTimeRemaining = 30;
            whackANumberScoreDisplay.textContent = `النقاط: 0`;
            whackANumberTimeDisplay.textContent = `الوقت: 30 ثانية`;
            whackANumberTargetDisplay.textContent = '';
            document.querySelectorAll('.number-display').forEach(d => d.classList.remove('up'));
            whackANumberStartButton.classList.remove('hidden');
            whackANumberResetButton.classList.add('hidden');
        }

        whackANumberStartButton.addEventListener('click', startWhackANumberGame);
        whackANumberResetButton.addEventListener('click', resetWhackANumberGame);


        // New Game 4: Reaction Time Game Logic
        const reactionButton = document.getElementById('reactionButton');
        const reactionMessage = document.getElementById('reactionMessage');
        const reactionTimeDisplay = document.getElementById('reactionTimeDisplay');
        const reactionStartButton = document.getElementById('reactionStartButton');
        const reactionResetButton = document.getElementById('reactionResetButton');

        let reactionGameTimeout;
        let reactionGameStartTime;
        let reactionGameActive = false;
        let reactionGameReady = false;
        let reactionWinMessageIndex = 0;
        const reactionWinMessages = [
            'كفو! ردة فعلك سريعة! ${time} مللي ثانية! ⚡',
            'ممتاز! ${time} مللي ثانية! ⏱️',
            'أحسنتِ! ${time} مللي ثانية! 🚀'
        ];

        function startReactionGame() {
            reactionGameActive = true;
            reactionGameReady = false;
            reactionMessage.textContent = 'استعدي...';
            reactionTimeDisplay.textContent = '';
            reactionButton.textContent = 'انتظري...';
            reactionButton.classList.remove('go');
            reactionButton.classList.add('ready');
            reactionStartButton.classList.add('hidden');
            reactionResetButton.classList.add('hidden');

            const randomDelay = Math.random() * 3000 + 1000; // 1 to 4 seconds
            reactionGameTimeout = setTimeout(() => {
                reactionGameReady = true;
                reactionButton.textContent = 'اضغطي الآن!';
                reactionButton.classList.remove('ready');
                reactionButton.classList.add('go');
                reactionGameStartTime = Date.now();
            }, randomDelay);
        }

        function handleReactionClick() {
            if (!reactionGameActive) return;

            if (reactionGameReady) {
                const reactionTime = Date.now() - reactionGameStartTime;
                reactionTimeDisplay.textContent = reactionWinMessages[reactionWinMessageIndex].replace('${time}', reactionTime);
                reactionWinMessageIndex = (reactionWinMessageIndex + 1) % reactionWinMessages.length;
                reactionMessage.textContent = 'أحسنتِ!';
                reactionGameActive = false;
                reactionResetButton.classList.remove('hidden');
            } else {
                clearTimeout(reactionGameTimeout);
                reactionMessage.textContent = 'ضغطتِ مبكرًا جداً! حاولي مرة أخرى.';
                reactionButton.textContent = 'اضغطي للبدء';
                reactionButton.classList.remove('ready', 'go');
                reactionGameActive = false;
                reactionResetButton.classList.remove('hidden');
                reactionTimeDisplay.textContent = '';
            }
        }

        function resetReactionGame() {
            clearTimeout(reactionGameTimeout);
            reactionGameActive = false;
            reactionGameReady = false;
            reactionMessage.textContent = '';
            reactionTimeDisplay.textContent = '';
            reactionButton.textContent = 'اضغطي للبدء';
            reactionButton.classList.remove('ready', 'go');
            reactionStartButton.classList.remove('hidden');
            reactionResetButton.classList.add('hidden');
        }

        reactionStartButton.addEventListener('click', startReactionGame);
        reactionButton.addEventListener('click', handleReactionClick);
        reactionResetButton.addEventListener('click', resetReactionGame);

        // New Game 5: Memory Sequence Game Logic
        const sequenceButtons = document.querySelectorAll('.sequence-button');
        const sequenceStatusDisplay = document.querySelector('.sequence-status');
        const sequenceStartButton = document.getElementById('sequenceStartButton');
        const sequenceResetButton = document.getElementById('sequenceResetButton');

        const sequenceColors = ['red', 'green', 'blue', 'yellow'];
        let gameSequence = [];
        let playerSequence = [];
        let level = 1;
        let canClick = false;
        let sequenceGameActive = false;
        let sequenceWinMessageIndex = 0;
        const sequenceWinMessages = [
            'كفو! أكملتِ المستوى ${level}! 💡',
            'ممتاز! انتقلتِ للمستوى ${level}! 🧠',
            'رائع! ذاكرتك قوية في المستوى ${level}! 🌟'
        ];
        const sequenceLoseMessages = [
            'خطأ! حاولي مرة أخرى. 😔',
            'لم تكن هذه هي التسلسل الصحيح. 🔄',
            'فشلت هذه الجولة. لا بأس، جربي مجدداً! 💔'
        ];
        let sequenceLoseMessageIndex = 0;

        function initializeMemorySequenceGame() {
            gameSequence = [];
            playerSequence = [];
            level = 1;
            canClick = false;
            sequenceGameActive = false;
            sequenceStatusDisplay.textContent = `المستوى: ${level}`;
            sequenceStartButton.classList.remove('hidden');
            sequenceResetButton.classList.add('hidden');
            sequenceButtons.forEach(button => {
                button.removeEventListener('click', handleSequenceClick);
                button.classList.remove('highlight');
            });
        }

        function startGameSequence() {
            sequenceGameActive = true;
            sequenceStartButton.classList.add('hidden');
            sequenceResetButton.classList.add('hidden'); // Hide reset button during game
            sequenceButtons.forEach(button => button.addEventListener('click', handleSequenceClick));
            playSequence();
        }

        function playSequence() {
            canClick = false;
            playerSequence = [];
            sequenceStatusDisplay.textContent = `المستوى: ${level}`;

            // Add a new random color to the sequence
            gameSequence.push(sequenceColors[Math.floor(Math.random() * sequenceColors.length)]);

            let i = 0;
            const highlightInterval = setInterval(() => {
                highlightButton(gameSequence[i]);
                i++;
                if (i >= gameSequence.length) {
                    clearInterval(highlightInterval);
                    canClick = true;
                    sequenceStatusDisplay.textContent = `المستوى: ${level} | دورك!`;
                }
            }, 800); // Time between highlights
        }

        function highlightButton(color) {
            const button = document.querySelector(`[data-color="${color}"]`);
            button.classList.add('highlight');
            // Play a sound if available (Tone.js or simple audio element)
            // For now, just visual highlight
            setTimeout(() => {
                button.classList.remove('highlight');
            }, 400); // Highlight duration
        }

        function handleSequenceClick(event) {
            if (!canClick) return;

            const clickedColor = event.target.dataset.color;
            playerSequence.push(clickedColor);
            highlightButton(clickedColor); // Highlight player's click

            const currentClickIndex = playerSequence.length - 1;

            if (playerSequence[currentClickIndex] === gameSequence[currentClickIndex]) {
                if (playerSequence.length === gameSequence.length) {
                    // Player completed the sequence for this level
                    canClick = false;
                    sequenceStatusDisplay.textContent = sequenceWinMessages[sequenceWinMessageIndex].replace('${level}', level);
                    sequenceWinMessageIndex = (sequenceWinMessageIndex + 1) % sequenceWinMessages.length;
                    level++;
                    setTimeout(playSequence, 1500); // Start next level after a delay
                }
            } else {
                // Player made a mistake
                sequenceGameActive = false;
                canClick = false;
                sequenceStatusDisplay.textContent = sequenceLoseMessages[sequenceLoseMessageIndex];
                sequenceLoseMessageIndex = (sequenceLoseMessageIndex + 1) % sequenceLoseMessages.length;
                sequenceResetButton.classList.remove('hidden');
                sequenceButtons.forEach(button => button.removeEventListener('click', handleSequenceClick));
            }
        }

        sequenceStartButton.addEventListener('click', startGameSequence);
        sequenceResetButton.addEventListener('click', initializeMemorySequenceGame);

        // New Game: Match 3 (Candy Crush-like) Logic
        const match3Grid = document.getElementById('match3Grid');
        const match3ScoreDisplay = document.querySelector('.match3-score');
        const match3MovesDisplay = document.querySelector('.match3-moves');
        const match3StartButton = document.getElementById('match3StartButton');
        const match3ResetButton = document.getElementById('match3ResetButton');

        const match3Emojis = ['🍓', '🍇', '🍋', '🍒', '🍊', '🍏']; // Emojis for candies
        const gridSize = 8;
        let match3Board = [];
        let match3Score = 0;
        let match3Moves = 20;
        let selectedCell = null; // Stores the first clicked cell
        let isProcessingMatch = false; // To prevent new clicks during match processing
        let match3GameRunning = false;
        const match3EndMessages = [
            'كفو! انتهت الجولة! جبتِ ${score} نقطة! 🏆',
            'انتهت الحركات! نقاطك: ${score}! 🌟',
            'ممتاز! نقاطك: ${score}! 🎉'
        ];
        let match3EndMessageIndex = 0;


        function initializeMatch3Game() {
            match3Score = 0;
            match3Moves = 20;
            match3ScoreDisplay.textContent = `النقاط: ${match3Score}`;
            match3MovesDisplay.textContent = `الحركات المتبقية: ${match3Moves}`;
            match3Board = [];
            selectedCell = null;
            isProcessingMatch = false;
            match3GameRunning = true;
            match3StartButton.classList.add('hidden');
            match3ResetButton.classList.add('hidden');
            createMatch3Board();
            checkForInitialMatches();
        }

        function createMatch3Board() {
            match3Grid.innerHTML = '';
            for (let i = 0; i < gridSize * gridSize; i++) {
                const cell = document.createElement('div');
                cell.classList.add('match3-cell');
                cell.dataset.index = i;
                cell.draggable = true;
                cell.addEventListener('dragstart', handleMatch3DragStart);
                cell.addEventListener('dragover', handleMatch3DragOver);
                cell.addEventListener('drop', handleMatch3Drop);
                cell.addEventListener('dragend', handleMatch3DragEnd);
                match3Grid.appendChild(cell);
                match3Board.push(''); // Placeholder for emoji
            }
            fillBoard();
        }

        function fillBoard() {
            for (let i = 0; i < gridSize * gridSize; i++) {
                if (match3Board[i] === '') {
                    const randomEmoji = match3Emojis[Math.floor(Math.random() * match3Emojis.length)];
                    match3Board[i] = randomEmoji;
                    match3Grid.children[i].textContent = randomEmoji;
                }
            }
        }

        function checkForInitialMatches() {
            let hasMatches = true;
            while (hasMatches) {
                hasMatches = false;
                const matches = findMatches();
                if (matches.length > 0) {
                    removeMatches(matches);
                    dropEmojis();
                    fillBoard();
                    hasMatches = true; // Keep checking until no more matches
                }
            }
        }

        function handleMatch3DragStart(e) {
            if (!match3GameRunning || isProcessingMatch) {
                e.preventDefault();
                return;
            }
            selectedCell = e.target;
            e.dataTransfer.setData('text/plain', selectedCell.dataset.index); // Store index of dragged cell
            selectedCell.classList.add('dragging');
        }

        function handleMatch3DragOver(e) {
            e.preventDefault(); // Allow drop
        }

        function handleMatch3Drop(e) {
            e.preventDefault();
            if (!match3GameRunning || isProcessingMatch) return;

            const draggedIndex = parseInt(e.dataTransfer.getData('text/plain'));
            const droppedCell = e.target;
            const droppedIndex = parseInt(droppedCell.dataset.index);

            // Check if they are adjacent
            const draggedRow = Math.floor(draggedIndex / gridSize);
            const draggedCol = draggedIndex % gridSize;
            const droppedRow = Math.floor(droppedIndex / gridSize);
            const droppedCol = droppedIndex % gridSize;

            const isAdjacent = (
                (Math.abs(draggedRow - droppedRow) === 1 && draggedCol === droppedCol) || // Vertical
                (Math.abs(draggedCol - droppedCol) === 1 && draggedRow === droppedRow)    // Horizontal
            );

            if (isAdjacent) {
                swapCells(draggedIndex, droppedIndex);
                match3Moves--;
                match3MovesDisplay.textContent = `الحركات المتبقية: ${match3Moves}`;
                setTimeout(processBoard, 500); // Process board after swap
            } else {
                // If not adjacent, just reset visual
                selectedCell.classList.remove('dragging');
                selectedCell = null;
            }
        }

        function handleMatch3DragEnd(e) {
            selectedCell.classList.remove('dragging');
            selectedCell = null;
        }

        function swapCells(index1, index2) {
            const tempEmoji = match3Board[index1];
            match3Board[index1] = match3Board[index2];
            match3Board[index2] = tempEmoji;

            match3Grid.children[index1].textContent = match3Board[index1];
            match3Grid.children[index2].textContent = match3Board[index2];
        }

        function processBoard() {
            isProcessingMatch = true;
            const matches = findMatches();

            if (matches.length > 0) {
                removeMatches(matches);
                setTimeout(() => {
                    dropEmojis();
                    fillBoard();
                    setTimeout(processBoard, 500); // Recursively process until no more matches
                }, 600); // Wait for fadeOut animation
            } else {
                // No matches after swap, swap back if it was a valid move but no match
                // For simplicity, we won't swap back in this version.
                // In a full game, you'd check if the swap *created* a match.
                isProcessingMatch = false;
                checkGameEndMatch3();
            }
        }

        function findMatches() {
            const matches = [];
            // Check horizontal matches
            for (let r = 0; r < gridSize; r++) {
                for (let c = 0; c < gridSize - 2; c++) {
                    const idx = r * gridSize + c;
                    const emoji1 = match3Board[idx];
                    const emoji2 = match3Board[idx + 1];
                    const emoji3 = match3Board[idx + 2];
                    if (emoji1 && emoji1 === emoji2 && emoji2 === emoji3) {
                        matches.push(idx, idx + 1, idx + 2);
                    }
                }
            }
            // Check vertical matches
            for (let c = 0; c < gridSize; c++) {
                for (let r = 0; r < gridSize - 2; r++) {
                    const idx = r * gridSize + c;
                    const emoji1 = match3Board[idx];
                    const emoji2 = match3Board[idx + gridSize];
                    const emoji3 = match3Board[idx + 2 * gridSize];
                    if (emoji1 && emoji1 === emoji2 && emoji2 === emoji3) {
                        matches.push(idx, idx + gridSize, idx + 2 * gridSize);
                    }
                }
            }
            return [...new Set(matches)]; // Return unique indices
        }

        function removeMatches(matchedIndices) {
            matchedIndices.forEach(index => {
                match3Board[index] = ''; // Clear emoji from board
                match3Grid.children[index].classList.add('matched'); // Add class for animation
                match3Score++; // Increase score for each removed emoji
            });
            match3ScoreDisplay.textContent = `النقاط: ${match3Score}`;
        }

        function dropEmojis() {
            for (let c = 0; c < gridSize; c++) {
                let emptyCells = [];
                for (let r = gridSize - 1; r >= 0; r--) {
                    const idx = r * gridSize + c;
                    if (match3Board[idx] === '') {
                        emptyCells.push(idx);
                    } else if (emptyCells.length > 0) {
                        // Move emoji down
                        const targetIdx = emptyCells.shift();
                        match3Board[targetIdx] = match3Board[idx];
                        match3Grid.children[targetIdx].textContent = match3Board[idx];
                        match3Grid.children[targetIdx].classList.remove('matched'); // Ensure no matched class
                        match3Board[idx] = '';
                        match3Grid.children[idx].textContent = '';
                        emptyCells.push(idx); // The cell where emoji was moved from becomes empty
                    }
                }
            }
        }

        function checkGameEndMatch3() {
            if (match3Moves <= 0 && findMatches().length === 0) {
                match3GameRunning = false;
                alertUser(match3EndMessages[match3EndMessageIndex].replace('${score}', match3Score));
                match3EndMessageIndex = (match3EndMessageIndex + 1) % match3EndMessages.length;
                match3ResetButton.classList.remove('hidden');
            }
        }

        match3StartButton.addEventListener('click', initializeMatch3Game);
        match3ResetButton.addEventListener('click', initializeMatch3Game);


        // New Game: Drag and Drop Sorting Logic
        const sortingItemsContainer = document.getElementById('sortingItems');
        const dropZones = document.querySelectorAll('.drop-zone');
        const sortingMessage = document.querySelector('.sorting-message');
        const sortingScoreDisplay = document.querySelector('.sorting-score');
        const sortingResetButton = document.getElementById('sortingResetButton');

        const sortingCategories = {
            fruits: ['🍎', '🍌', '🍓', '🍇', '🍍'],
            animals: ['🦁', '🐵', '🐘', '🦒', '🐼'],
            vehicles: ['🚗', '🚌', '🚲', '✈️', '🚢']
        };
        let currentSortingItems = [];
        let sortingScore = 0;
        let totalItems = 0;
        let draggedItem = null;

        function initializeSortingGame() {
            sortingScore = 0;
            totalItems = 0;
            sortingScoreDisplay.textContent = `النقاط: ${sortingScore}`;
            sortingMessage.textContent = '';
            sortingItemsContainer.innerHTML = '';
            dropZones.forEach(zone => zone.innerHTML = zone.dataset.category === 'fruits' ? 'فواكه 🍎' : (zone.dataset.category === 'animals' ? 'حيوانات 🦁' : 'مركبات 🚗')); // Reset drop zone content

            currentSortingItems = [];
            const allItems = [];
            for (const category in sortingCategories) {
                sortingCategories[category].forEach(item => {
                    allItems.push({ emoji: item, category: category });
                });
            }
            shuffleArray(allItems); // Shuffle all items

            // Pick a subset of items for the game
            const itemsToDisplay = allItems.slice(0, 6); // Display 6 random items
            totalItems = itemsToDisplay.length;

            itemsToDisplay.forEach(item => {
                const itemElement = document.createElement('div');
                itemElement.classList.add('draggable-item');
                itemElement.textContent = item.emoji;
                itemElement.draggable = true;
                itemElement.dataset.category = item.category;
                itemElement.addEventListener('dragstart', handleSortingDragStart);
                sortingItemsContainer.appendChild(itemElement);
            });

            dropZones.forEach(zone => {
                zone.addEventListener('dragover', handleSortingDragOver);
                zone.addEventListener('dragleave', handleSortingDragLeave);
                zone.addEventListener('drop', handleSortingDrop);
            });
        }

        function handleSortingDragStart(e) {
            draggedItem = e.target;
            e.dataTransfer.setData('text/plain', draggedItem.dataset.category);
            e.dataTransfer.effectAllowed = 'move';
        }

        function handleSortingDragOver(e) {
            e.preventDefault();
            e.dataTransfer.dropEffect = 'move';
            e.target.classList.add('drag-over');
        }

        function handleSortingDragLeave(e) {
            e.target.classList.remove('drag-over');
        }

        function handleSortingDrop(e) {
            e.preventDefault();
            e.target.classList.remove('drag-over');

            const droppedCategory = e.target.dataset.category;
            const draggedCategory = draggedItem.dataset.category;

            if (droppedCategory === draggedCategory) {
                sortingScore++;
                sortingScoreDisplay.textContent = `النقاط: ${sortingScore}`;
                sortingMessage.textContent = 'كفو! صح عليك! 🎉';
                draggedItem.remove(); // Remove item from display
                checkSortingGameEnd();
            } else {
                sortingMessage.textContent = 'خطأ! هذا مو مكانه. 😔';
            }
        }

        function checkSortingGameEnd() {
            if (sortingItemsContainer.children.length === 0) {
                sortingMessage.textContent = `خلصتِ كل التصنيفات! نقاطك النهائية: ${sortingScore} من ${totalItems}! 🏆`;
            }
        }

        sortingResetButton.addEventListener('click', initializeSortingGame);

        // New Game: Quick Click Logic
        const clickArea = document.getElementById('clickArea');
        const targetButton = document.getElementById('targetButton');
        const quickClickScoreDisplay = document.querySelector('.quick-click-score');
        const quickClickTimeDisplay = document.querySelector('.quick-click-time');
        const quickClickStartButton = document.getElementById('quickClickStartButton');
        const quickClickResetButton = document.getElementById('quickClickResetButton');

        let quickClickScore = 0;
        let quickClickTimeRemaining = 15;
        let quickClickTimerId;
        let quickClickGameRunning = false;
        let quickClickEndMessageIndex = 0;
        const quickClickEndMessages = [
            'كفو! جبتِ ${score} نقطة! 🏆',
            'انتهى الوقت! نقاطك: ${score}! ✨',
            'ممتاز! نقاطك: ${score}! 🎉'
        ];

        function positionTargetButton() {
            if (!quickClickGameRunning) return;
            const areaWidth = clickArea.offsetWidth;
            const areaHeight = clickArea.offsetHeight;
            const buttonSize = targetButton.offsetWidth;

            const randomX = Math.random() * (areaWidth - buttonSize);
            const randomY = Math.random() * (areaHeight - buttonSize);

            targetButton.style.left = `${randomX}px`;
            targetButton.style.top = `${randomY}px`;
            targetButton.classList.remove('hidden');
        }

        function handleTargetButtonClick() {
            if (!quickClickGameRunning) return;
            quickClickScore++;
            quickClickScoreDisplay.textContent = `النقاط: ${quickClickScore}`;
            targetButton.classList.add('hidden'); // Hide immediately
            positionTargetButton(); // Show in new position
        }

        function startQuickClickGame() {
            quickClickScore = 0;
            quickClickTimeRemaining = 15;
            quickClickScoreDisplay.textContent = `النقاط: ${quickClickScore}`;
            quickClickTimeDisplay.textContent = `الوقت: ${quickClickTimeRemaining} ثانية`;
            quickClickGameRunning = true;
            quickClickStartButton.classList.add('hidden');
            quickClickResetButton.classList.add('hidden');
            
            positionTargetButton(); // Initial position

            quickClickTimerId = setInterval(() => {
                quickClickTimeRemaining--;
                quickClickTimeDisplay.textContent = `الوقت: ${quickClickTimeRemaining} ثانية`;
                if (quickClickTimeRemaining <= 0) {
                    clearInterval(quickClickTimerId);
                    quickClickGameRunning = false;
                    quickClickTimeDisplay.textContent = `انتهى الوقت!`;
                    targetButton.classList.add('hidden'); // Hide button
                    quickClickStartButton.classList.remove('hidden');
                    quickClickResetButton.classList.remove('hidden');
                    alertUser(quickClickEndMessages[quickClickEndMessageIndex].replace('${score}', quickClickScore));
                    quickClickEndMessageIndex = (quickClickEndMessageIndex + 1) % quickClickEndMessages.length;
                }
            }, 1000);
        }

        function resetQuickClickGame() {
            clearInterval(quickClickTimerId);
            quickClickGameRunning = false;
            quickClickScore = 0;
            quickClickTimeRemaining = 15;
            quickClickScoreDisplay.textContent = `النقاط: 0`;
            quickClickTimeDisplay.textContent = `الوقت: 15 ثانية`;
            targetButton.classList.add('hidden');
            quickClickStartButton.classList.remove('hidden');
            quickClickResetButton.classList.add('hidden');
        }

        targetButton.addEventListener('click', handleTargetButtonClick);
        quickClickStartButton.addEventListener('click', startQuickClickGame);
        quickClickResetButton.addEventListener('click', resetQuickClickGame);

        // New Game: Maze Game Logic
        const mazeCanvas = document.getElementById('mazeCanvas');
        const mazeCtx = mazeCanvas.getContext('2d');
        const mazeMessage = document.querySelector('.maze-message');
        const mazeResetButton = document.getElementById('mazeResetButton');

        const TILE_SIZE = 30; // Size of each cell in the maze
        const PLAYER_SIZE = TILE_SIZE * 0.7;
        const WALL_COLOR = '#443e52';
        const PATH_COLOR = '#221c27';
        const PLAYER_COLOR = '#f8bbd0'; // Pink
        const END_COLOR = '#81c784'; // Green
        const START_COLOR = '#b3e5fc'; // Light Blue

        // Simple fixed maze (0 = path, 1 = wall, 2 = start, 3 = end)
        const maze = [
            [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1],
            [1, 2, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1],
            [1, 1, 1, 1, 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1],
            [1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 1],
            [1, 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 0, 1],
            [1, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 1, 0, 1],
            [1, 0, 1, 0, 1, 1, 1, 1, 1, 1, 0, 1, 0, 1, 0, 1],
            [1, 0, 1, 0, 1, 0, 0, 0, 0, 1, 0, 1, 0, 1, 0, 1],
            [1, 0, 1, 0, 1, 0, 1, 1, 0, 1, 0, 1, 0, 1, 0, 1],
            [1, 0, 1, 0, 1, 0, 1, 1, 0, 1, 0, 1, 0, 1, 0, 1],
            [1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 3, 1],
            [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1]
        ];

        let player = { x: 1, y: 1 }; // Start position (column, row)
        let mazeGameActive = false;

        function resizeMazeCanvas() {
            // Calculate canvas size based on maze dimensions and tile size
            mazeCanvas.width = maze[0].length * TILE_SIZE;
            mazeCanvas.height = maze.length * TILE_SIZE;
            drawMaze();
        }

        function drawMaze() {
            mazeCtx.clearRect(0, 0, mazeCanvas.width, mazeCanvas.height);
            for (let row = 0; row < maze.length; row++) {
                for (let col = 0; col < maze[row].length; col++) {
                    const cellType = maze[row][col];
                    const x = col * TILE_SIZE;
                    const y = row * TILE_SIZE;

                    if (cellType === 1) { // Wall
                        mazeCtx.fillStyle = WALL_COLOR;
                    } else if (cellType === 2) { // Start
                        mazeCtx.fillStyle = START_COLOR;
                    } else if (cellType === 3) { // End
                        mazeCtx.fillStyle = END_COLOR;
                    } else { // Path
                        mazeCtx.fillStyle = PATH_COLOR;
                    }
                    mazeCtx.fillRect(x, y, TILE_SIZE, TILE_SIZE);
                }
            }
            drawPlayer();
        }

        function drawPlayer() {
            mazeCtx.fillStyle = PLAYER_COLOR;
            const playerX = player.x * TILE_SIZE + (TILE_SIZE - PLAYER_SIZE) / 2;
            const playerY = player.y * TILE_SIZE + (TILE_SIZE - PLAYER_SIZE) / 2;
            mazeCtx.beginPath();
            mazeCtx.arc(playerX + PLAYER_SIZE / 2, playerY + PLAYER_SIZE / 2, PLAYER_SIZE / 2, 0, Math.PI * 2);
            mazeCtx.fill();
        }

        function movePlayer(dx, dy) {
            if (!mazeGameActive) return;

            const newPlayerX = player.x + dx;
            const newPlayerY = player.y + dy;

            // Check boundaries
            if (newPlayerX >= 0 && newPlayerX < maze[0].length &&
                newPlayerY >= 0 && newPlayerY < maze.length) {
                
                const targetCellType = maze[newPlayerY][newPlayerX];

                if (targetCellType !== 1) { // If not a wall
                    player.x = newPlayerX;
                    player.y = newPlayerY;
                    drawMaze(); // Redraw maze with new player position

                    if (targetCellType === 3) { // Reached end
                        mazeMessage.textContent = 'كفو! وصلتِ للنهاية! 🎉';
                        mazeGameActive = false;
                    }
                } else {
                    mazeMessage.textContent = 'هذا جدار! حاولي مسار ثاني. 🚧';
                }
            }
        }

        function handleMazeKeyDown(e) {
            if (!mazeGameActive) return;
            switch (e.key) {
                case 'ArrowUp':
                    movePlayer(0, -1);
                    break;
                case 'ArrowDown':
                    movePlayer(0, 1);
                    break;
                case 'ArrowLeft':
                    movePlayer(-1, 0);
                    break;
                case 'ArrowRight':
                    movePlayer(1, 0);
                    break;
            }
        }
        window.addEventListener('keydown', handleMazeKeyDown);

        // Touch swipe for Maze Game
        let touchStartX = 0;
        let touchStartY = 0;

        mazeCanvas.addEventListener('touchstart', (e) => {
            if (!mazeGameActive) return;
            e.preventDefault();
            touchStartX = e.touches[0].clientX;
            touchStartY = e.touches[0].clientY;
        }, { passive: false });

        mazeCanvas.addEventListener('touchend', (e) => {
            if (!mazeGameActive) return;
            e.preventDefault();
            const touchEndX = e.changedTouches[0].clientX;
            const touchEndY = e.changedTouches[0].clientY;

            const dx = touchEndX - touchStartX;
            const dy = touchEndY - touchStartY;

            // Determine swipe direction
            if (Math.abs(dx) > Math.abs(dy)) { // Horizontal swipe
                if (dx > 0) movePlayer(1, 0); // Right
                else movePlayer(-1, 0); // Left
            } else { // Vertical swipe
                if (dy > 0) movePlayer(0, 1); // Down
                else movePlayer(0, -1); // Up
            }
        }, { passive: false });


        function initializeMazeGame() {
            player = { x: 1, y: 1 }; // Reset player position
            mazeGameActive = true;
            mazeMessage.textContent = 'استخدمي الأسهم أو اسحبي للتحرك.';
            resizeMazeCanvas(); // Redraw maze
        }

        mazeResetButton.addEventListener('click', initializeMazeGame);


        // Initial setup on window load
        window.onload = function() {
            console.log('الصفحة جاهزة. الرجاء النقر على زر التشغيل.');
            initializeGuessNumberGame(); // Initialize Guess the Number game on load
            initializeMemoryGame(); // Initialize Memory Match game on load
            createMoleHoles(); // Create mole holes for Whack-a-Mole
            initializeColorMatchGame(); // Initialize Color Match game on load
            createNumberHoles(); // Create holes for Whack-a-Number
            initializeDrawingPad(); // Initial resize for drawing canvas
            initializeMemorySequenceGame(); // Initialize Memory Sequence game
            initializeMatch3Game(); // Initialize Match 3 game
            initializeSortingGame(); // Initialize Sorting Game
            initializeQuickClickGame(); // Initialize Quick Click Game
            initializeMazeGame(); // Initialize Maze Game
            // Bubble Pop game and Catch Stars game start with a button click, no initial setup needed here
        };
    </script>
</body>
</html>
